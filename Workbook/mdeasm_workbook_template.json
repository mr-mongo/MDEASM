{
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workbookDisplayName": {
      "type": "string",
      "defaultValue": "EASM Workbook",
      "metadata": {
        "description": "The friendly name for the workbook that is used in the Gallery or Saved List.  This name must be unique within a resource group."
      }
    },
    "workbookType": {
      "type": "string",
      "defaultValue": "workbook",
      "metadata": {
        "description": "The gallery that the workbook will been shown under. Supported values include workbook, tsg, etc. Usually, this is 'workbook'"
      }
    },
    "logAnalyticsWorkspace": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "The name of the Log Analytics workspace to which this workbook will be associated"
      }
    },
    "logAnalyticsResourceGroup": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "The Resource Group of the Log Analytics workspace to which this workbook will be associated"
      }
    },
    "workbookId": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "metadata": {
        "description": "The unique guid for this workbook instance"
      }
    }
  },
  "variables": {
    "workbookSourceId": "[resourceId(parameters('logAnalyticsResourceGroup'), 'microsoft.operationalinsights/workspaces', parameters('logAnalyticsWorkspace'))]"
  },
  "resources": [
    {
      "name": "[parameters('workbookId')]",
      "type": "microsoft.insights/workbooks",
      "location": "[resourceGroup().location]",
      "apiVersion": "2021-03-08",
      "dependsOn": [],
      "kind": "shared",
      "properties": {
        "displayName": "[parameters('workbookDisplayName')]",
        "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"63f093d6-7fff-49c7-be5c-b5ae4ab28bb0\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_workbook_source\",\"label\":\"Workbook Data Source\",\"type\":10,\"description\":\"Select the data source for this workbook\",\"isRequired\":true,\"isGlobal\":true,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"Log Analytics\\\",\\\"Azure Data Explorer\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"Azure Data Explorer\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"customWidth\":\"20\",\"name\":\"WorkbookSources\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"64eb843a-d545-440c-9776-b61f3b9c7225\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_cluster_uri\",\"label\":\"ADX Cluster URI\",\"type\":1,\"description\":\"https://__cluster_name__.__cluster_region__.kusto.windows.net\",\"isRequired\":true,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"https://__cluster_name__.__cluster_region__.kusto.windows.net\"},{\"id\":\"5b5b5fa5-5a5a-45ba-9374-5b35193c4192\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_database_name\",\"label\":\"ADX Database Name\",\"type\":1,\"description\":\"__database_name__\",\"isRequired\":true,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"__database_name__\"},{\"id\":\"6736f8d1-7ac2-42db-91ea-31e78d435b93\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_workspace_name\",\"label\":\"EASM Workspace Name\",\"type\":2,\"isRequired\":true,\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"EasmAsset\\\\r\\\\n|summarize by WorkspaceName\\\\r\\\\n|order by WorkspaceName asc\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"queryType\":9,\"value\":\"CocaCola\"},{\"id\":\"bd8327e7-6805-4c87-8388-47ad68fb69a7\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_snapshot\",\"label\":\"Asset Snapshot Date\",\"type\":2,\"isRequired\":true,\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|summarize by SnapshotDateTime\\\\r\\\\n|sort by SnapshotDateTime desc\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"queryType\":9,\"value\":\"2023-02-02T22:12:39Z\"},{\"id\":\"b5b5729c-1a7b-4465-8673-cdfcc6073731\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_lastseen\",\"label\":\"Last Seen Within\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":2592000000}}],\"style\":\"above\",\"doNotRunWhenHidden\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"customWidth\":\"74\",\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADXClusterParameters\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f7c71b4f-116f-4866-bab5-a82909d0fc46\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_workspace\",\"label\":\"Log Analytics Workspace\",\"type\":5,\"isRequired\":true,\"isGlobal\":true,\"typeSettings\":{\"resourceTypeFilter\":{\"microsoft.operationalinsights/workspaces\":true},\"additionalResourceOptions\":[]},\"timeContext\":{\"durationMs\":86400000},\"value\":\"\"},{\"id\":\"f7320109-da82-4eca-9f94-c6256c8a405f\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_workspace_name\",\"label\":\"EASM Workspace Name\",\"type\":2,\"isRequired\":true,\"query\":\"EasmAsset_CL\\r\\n|summarize by WorkspaceName_s\\r\\n|order by WorkspaceName_s asc\",\"crossComponentResources\":[\"{_la_workspace}\"],\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":\"Samsung19FEB\"},{\"id\":\"9ef8f492-9d49-4314-b6c1-1d2286153f33\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_snapshot\",\"label\":\"Asset Snapshot Date\",\"type\":2,\"isRequired\":true,\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|summarize by SnapshotDateTime_t\\r\\n|sort by SnapshotDateTime_t desc\",\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":\"2023-02-24T06:24:46.9039511Z\"},{\"id\":\"95d506d7-3730-4a94-813a-e9065a6ca448\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_lastseen\",\"label\":\"Last Seen Within\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":2592000000}}],\"style\":\"above\",\"doNotRunWhenHidden\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"customWidth\":\"74\",\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LAWorkspaceParameters\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"c0ba54ab-2c3f-4758-a149-77bbd311d6b0\",\"cellValue\":\"ADXClusterParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu ||\",\"style\":\"primary\"},{\"id\":\"f598ddc1-769b-425f-930b-0212df462ed3\",\"cellValue\":\"ADX Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"490c6ce3-b954-4eba-b8c8-20240915a19e\",\"cellValue\":\"ADX Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"317316dc-258d-4f51-90b3-0a6b4fed3908\",\"cellValue\":\"ADX CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"168fd11c-6ec6-4e47-a632-e16cb4958ec8\",\"cellValue\":\"ADX Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"1ce7279b-8e43-43aa-b82a-e9363e8cae3e\",\"cellValue\":\"ADX IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"13ec12b7-d2b1-4f61-801e-c73076a19226\",\"cellValue\":\"ADX Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"40c2b047-ec0a-4e29-9ed2-6f4a77484d44\",\"cellValue\":\"ADX SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"af18dea8-4dbb-46a7-b472-3ccb71412493\",\"cellValue\":\"ADX Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX Navigation Menu_top\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"2224ebc2-b78c-4d7a-8ccf-a5981db0f81d\",\"cellValue\":\"LAWorkspaceParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu  ||\",\"style\":\"primary\"},{\"id\":\"63020326-d7fa-4835-943f-13f67a63eaf1\",\"cellValue\":\"LA Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"de135273-c57e-414f-b35b-8f447ccf3f15\",\"cellValue\":\"LA Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"30bd0ef2-4cd0-455b-98d9-cc9b99745b87\",\"cellValue\":\"LA CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"0e75f6c8-14bb-4444-80c5-69e42f82d997\",\"cellValue\":\"LA Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"2e22e940-4d70-445f-9fb9-568367779e47\",\"cellValue\":\"LA IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"a4a094d8-58d2-47c2-8d06-f58a1282af8d\",\"cellValue\":\"LA Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"5a9e1f4c-6ec3-4396-b0f5-9748c60854aa\",\"cellValue\":\"LA SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"cd87e49d-e619-498a-85e7-1ba03ecf9785\",\"cellValue\":\"LA Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA Navigation Menu_top\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Workspace Summary\",\"expandable\":true,\"expanded\":true,\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|summarize Count=count() by AssetType\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":4,\"showAnalytics\":true,\"title\":\"Asset Types\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"AssetType\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":false,\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true,\"sortOrderField\":2,\"size\":\"auto\"}},\"customWidth\":\"83\",\"name\":\"ADX Asset Types\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|extend TotalCount = 'Total'\\\\r\\\\n|summarize Total=count() by TotalCount\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":4,\"showAnalytics\":true,\"title\":\"Asset Count\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"TotalCount\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Total\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":false,\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true,\"sortOrderField\":2,\"size\":\"auto\"}},\"customWidth\":\"17\",\"name\":\"ADX Asset Count\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|summarize Count=count() by AssetType,SnapshotDateTime\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"aggregation\":5,\"showAnnotations\":true,\"showAnalytics\":true,\"title\":\"Asset Types Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"timechart\",\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AssetType\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}}},\"customWidth\":\"60\",\"name\":\"ADX Asset Types Over Time\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmIpAddressAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|where array_length(Locations) > 0\\\\r\\\\n|union kind=inner (EasmHostAsset | where WorkspaceName == workspace|where SnapshotDateTime == '{_adx_snapshot}'|where array_length(Locations) > 0)\\\\r\\\\n|project-keep Locations,AssetName\\\\r\\\\n|mv-expand Locations\\\\r\\\\n|extend Region = tostring(Locations.Region), City = tostring(Locations.City), Latitude = toreal(Locations.Latitude), Longitude = toreal(Locations.Longitude), LocationLastSeen = todatetime(Locations.LastSeen), LocationFirstSeen = todatetime(Locations.FirstSeen)\\\\r\\\\n|where isnotempty(Latitude) and isnotempty(Longitude) and isnotempty(Region) and isnotempty(City)\\\\r\\\\n\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Asset Locations\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"map\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Region\",\"formatter\":1},\"subtitleContent\":{\"columnMatch\":\"City\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"}},\"showBorder\":false,\"sortCriteriaField\":\"Count\",\"sortOrderField\":2,\"size\":\"auto\"},\"mapSettings\":{\"locInfo\":\"LatLong\",\"locInfoColumn\":\"Region\",\"latitude\":\"Latitude\",\"longitude\":\"Longitude\",\"sizeSettings\":\"Latitude\",\"sizeAggregation\":\"Count\",\"opacity\":0.9,\"labelSettings\":\"City\",\"legendMetric\":\"City\",\"numberOfMetrics\":20,\"legendAggregation\":\"Count\",\"itemColorSettings\":{\"nodeColorField\":\"Latitude\",\"colorAggregation\":\"Count\",\"type\":\"heatmap\",\"heatmapPalette\":\"categorical\",\"heatmapMin\":5}}},\"customWidth\":\"40\",\"name\":\"ADX Asset Locations\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"92020e51-938f-4494-91af-80caea4acaff\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_port_summary\",\"label\":\"Ports Summary\",\"type\":10,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"By System\\\",\\\"By Port\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":null},{\"id\":\"95a2aeca-1b0a-413e-b7b2-b8e6a151cb03\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_system_type\",\"label\":\"Ports System Types\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"All\\\",\\\"IPs Only\\\",\\\"Hosts Only\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"All\"},{\"id\":\"e28addca-dc23-4e48-b4b9-211fc259b52c\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_has_banner\",\"label\":\"Has Banner?\",\"type\":10,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"Yes\\\"]\",\"value\":null},{\"id\":\"90b75bbd-3440-4d59-96c4-1ebdaae52504\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_port_sort\",\"label\":\"Ports Sort\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"value\":\"asc\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"ADX Port Summary\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nunion isfuzzy=true (\\\\r\\\\n    EasmHostAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = Host\\\\r\\\\n    |extend Source = 'EasmHostAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    ),\\\\r\\\\n    (\\\\r\\\\n    EasmIpAddressAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = IpAddress\\\\r\\\\n    |extend Source = 'EasmIpAddressAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    )\\\\r\\\\n|extend Keep = case('{_adx_system_type}' == 'IPs Only', 'EasmIpAddressAsset', '{_adx_system_type}' == 'Hosts Only', 'EasmHostAsset', 'EasmHostAsset,EasmIpAddressAsset')\\\\r\\\\n|where Keep has Source\\\\r\\\\n|sort by System {_adx_port_sort}\\\\r\\\\n|project-away Source,Keep\\\\r\\\\n//|summarize AllPorts = make_set(Port) by System\\\\r\\\\n//|summarize AllSystems = make_set(System) by Port\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportParameterName\":\"_adx_port_to_assetlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"System\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"25ch\"}}],\"rowLimit\":5000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_adx_port_summary\",\"comparison\":\"isNotEqualTo\",\"value\":\"By System\"},{\"parameterName\":\"_adx_port_summary\",\"comparison\":\"isNotEqualTo\",\"value\":\"By Port\"},{\"parameterName\":\"_adx_has_banner\",\"comparison\":\"isNotEqualTo\",\"value\":\"Yes\"}],\"name\":\"ADX All Ports_no groupBy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nunion isfuzzy=true (\\\\r\\\\n    EasmHostAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = Host\\\\r\\\\n    |extend Source = 'EasmHostAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    ),\\\\r\\\\n    (\\\\r\\\\n    EasmIpAddressAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = IpAddress\\\\r\\\\n    |extend Source = 'EasmIpAddressAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    )\\\\r\\\\n|extend Keep = case('{_adx_system_type}' == 'IPs Only', 'EasmIpAddressAsset', '{_adx_system_type}' == 'Hosts Only', 'EasmHostAsset', 'EasmHostAsset,EasmIpAddressAsset')\\\\r\\\\n|where Keep has Source\\\\r\\\\n|join (EasmAssetBanner\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '2023-02-02T22:12:39Z'\\\\r\\\\n    |where BannerLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project-keep AssetName,Port\\\\r\\\\n) on $left.System == $right.AssetName, $left.Port == $right.Port\\\\r\\\\n|sort by System {_adx_port_sort}\\\\r\\\\n|project-away Source,Keep,Port1,AssetName\\\\r\\\\n//|summarize AllPorts = make_set(Port) by System\\\\r\\\\n//|summarize AllSystems = make_set(System) by Port\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportParameterName\":\"_adx_port_to_assetlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"System\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"25ch\"}}],\"rowLimit\":5000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_adx_port_summary\",\"comparison\":\"isNotEqualTo\",\"value\":\"By System\"},{\"parameterName\":\"_adx_port_summary\",\"comparison\":\"isNotEqualTo\",\"value\":\"By Port\"},{\"parameterName\":\"_adx_has_banner\",\"comparison\":\"isEqualTo\",\"value\":\"Yes\"}],\"name\":\"ADX All Ports_no groupBy_hasBanner\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nunion isfuzzy=true (\\\\r\\\\n    EasmHostAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = Host\\\\r\\\\n    |extend Source = 'EasmHostAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    ),\\\\r\\\\n    (\\\\r\\\\n    EasmIpAddressAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = IpAddress\\\\r\\\\n    |extend Source = 'EasmIpAddressAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    )\\\\r\\\\n|extend Keep = case('{_adx_system_type}' == 'IPs Only', 'EasmIpAddressAsset', '{_adx_system_type}' == 'Hosts Only', 'EasmHostAsset', 'EasmHostAsset,EasmIpAddressAsset')\\\\r\\\\n|where Keep has Source\\\\r\\\\n|summarize AllPorts = make_set(Port) by System\\\\r\\\\n//|summarize AllSystems = make_set(System) by Port\\\\r\\\\n|sort by System {_adx_port_sort}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_adx_port_to_assetlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"System\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}}],\"rowLimit\":1000,\"filter\":true,\"sortBy\":[{\"itemKey\":\"System\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"System\",\"sortOrder\":1}],\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_adx_port_summary\",\"comparison\":\"isEqualTo\",\"value\":\"By System\"},{\"parameterName\":\"_adx_has_banner\",\"comparison\":\"isNotEqualTo\",\"value\":\"Yes\"}],\"name\":\"ADX All Ports_groupBy System\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nunion isfuzzy=true (\\\\r\\\\n    EasmHostAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = Host\\\\r\\\\n    |extend Source = 'EasmHostAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    ),\\\\r\\\\n    (\\\\r\\\\n    EasmIpAddressAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = IpAddress\\\\r\\\\n    |extend Source = 'EasmIpAddressAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    )\\\\r\\\\n|extend Keep = case('{_adx_system_type}' == 'IPs Only', 'EasmIpAddressAsset', '{_adx_system_type}' == 'Hosts Only', 'EasmHostAsset', 'EasmHostAsset,EasmIpAddressAsset')\\\\r\\\\n|where Keep has Source\\\\r\\\\n|join (EasmAssetBanner\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where BannerLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project-keep AssetName,Port\\\\r\\\\n) on $left.System == $right.AssetName, $left.Port == $right.Port\\\\r\\\\n|summarize AllPorts = make_set(Port) by System\\\\r\\\\n//|summarize AllSystems = make_set(System) by Port\\\\r\\\\n|sort by System {_adx_port_sort}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_adx_port_to_assetlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"System\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}}],\"rowLimit\":1000,\"filter\":true,\"sortBy\":[{\"itemKey\":\"System\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"System\",\"sortOrder\":1}],\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_adx_port_summary\",\"comparison\":\"isEqualTo\",\"value\":\"By System\"},{\"parameterName\":\"_adx_has_banner\",\"comparison\":\"isEqualTo\",\"value\":\"Yes\"}],\"name\":\"ADX All Ports_groupBy System_hasBanner\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nunion isfuzzy=true (\\\\r\\\\n    EasmHostAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = Host\\\\r\\\\n    |extend Source = 'EasmHostAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    ),\\\\r\\\\n    (\\\\r\\\\n    EasmIpAddressAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = IpAddress\\\\r\\\\n    |extend Source = 'EasmIpAddressAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    )\\\\r\\\\n|extend Keep = case('{_adx_system_type}' == 'IPs Only', 'EasmIpAddressAsset', '{_adx_system_type}' == 'Hosts Only', 'EasmHostAsset', 'EasmHostAsset,EasmIpAddressAsset')\\\\r\\\\n|where Keep has Source\\\\r\\\\n//|summarize AllPorts = make_set(Port) by System\\\\r\\\\n|summarize AllSystems = make_set(System) by Port\\\\r\\\\n|sort by Port {_adx_port_sort}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_adx_port_to_portlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":1000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_adx_port_summary\",\"comparison\":\"isEqualTo\",\"value\":\"By Port\"},{\"parameterName\":\"_adx_has_banner\",\"comparison\":\"isNotEqualTo\",\"value\":\"Yes\"}],\"name\":\"ADX All Ports_groupBy Port\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nunion isfuzzy=true (\\\\r\\\\n    EasmHostAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = Host\\\\r\\\\n    |extend Source = 'EasmHostAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    ),\\\\r\\\\n    (\\\\r\\\\n    EasmIpAddressAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = IpAddress\\\\r\\\\n    |extend Source = 'EasmIpAddressAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    )\\\\r\\\\n|extend Keep = case('{_adx_system_type}' == 'IPs Only', 'EasmIpAddressAsset', '{_adx_system_type}' == 'Hosts Only', 'EasmHostAsset', 'EasmHostAsset,EasmIpAddressAsset')\\\\r\\\\n|where Keep has Source\\\\r\\\\n|join (EasmAssetBanner\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where BannerLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project-keep AssetName,Port\\\\r\\\\n) on $left.System == $right.AssetName, $left.Port == $right.Port\\\\r\\\\n//|summarize AllPorts = make_set(Port) by System\\\\r\\\\n|summarize AllSystems = make_set(System) by Port\\\\r\\\\n|sort by Port {_adx_port_sort}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_adx_port_to_portlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":1000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_adx_port_summary\",\"comparison\":\"isEqualTo\",\"value\":\"By Port\"},{\"parameterName\":\"_adx_has_banner\",\"comparison\":\"isEqualTo\",\"value\":\"Yes\"}],\"name\":\"ADX All Ports_groupBy Port_hasBanner\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet asset_name = tostring(parse_json('{_adx_port_to_assetlookup}').System);\\\\r\\\\nEasmAssetBanner\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|where AssetName == asset_name\\\\r\\\\n|where BannerLastSeen {_adx_lastseen:query}\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by Port,ScanType\\\\r\\\\n|project-keep AssetName, Port, ScanType, Banner*\\\\r\\\\n|project-reorder AssetName,Port,ScanType,Banner\\\\r\\\\n|sort by Port {_adx_port_sort}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Asset Banners\",\"noDataMessage\":\"No Banner information found. Select a (different) row from All Ports\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":500,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"65\",\"conditionalVisibility\":{\"parameterName\":\"_adx_port_to_portlookup\",\"comparison\":\"isEqualTo\"},\"name\":\"ADX Asset Banners by System\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet port_num = replace_regex('{_adx_port_to_portlookup}', @'.+Port\\\\\\\":(\\\\\\\\d+).+', @'\\\\\\\\1');\\\\r\\\\nEasmAssetBanner\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|where Port == port_num\\\\r\\\\n|where BannerLastSeen {_adx_lastseen:query}\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetName,ScanType\\\\r\\\\n|project-keep AssetName, Port, ScanType, Banner*\\\\r\\\\n|project-reorder AssetName,Port,ScanType,Banner\\\\r\\\\n|sort by AssetName {_adx_port_sort}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Asset Banners\",\"noDataMessage\":\"No Banner information found. Select a (different) row from All Ports\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":500,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"65\",\"conditionalVisibility\":{\"parameterName\":\"_adx_port_to_assetlookup\",\"comparison\":\"isEqualTo\"},\"name\":\"ADX Asset Banners by Port\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"df71056a-a50d-423b-82ab-204948cebc96\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_wc_sort\",\"label\":\"Sort Web Component\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"desc\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"ADX Web Components\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|where AssetLastSeen {_adx_lastseen:query} and WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|extend Name = WebComponentName, Version = WebComponentVersion\\\\r\\\\n|project-keep Name,Version,SnapshotDateTime,AssetName\\\\r\\\\n|summarize Count=count() by Name,Version\\\\r\\\\n|sort by Count {_adx_wc_sort}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Web Components\",\"showRefreshButton\":true,\"exportParameterName\":\"_adx_wc_detail\",\"exportDefaultValue\":\"{\\\"Name\\\":\\\"\\\",\\\"Version\\\":\\\"\\\",\\\"Category\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"$gen_group\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}},{\"columnMatch\":\"Group\",\"formatter\":1,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}},{\"columnMatch\":\"Name\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"25ch\"}},{\"columnMatch\":\"Version\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"11ch\"}},{\"columnMatch\":\"$gen_group\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}}],\"rowLimit\":5000,\"filter\":true,\"hierarchySettings\":{\"treeType\":1,\"groupBy\":[\"Name\"],\"expandTopLevel\":true}}},\"customWidth\":\"40\",\"name\":\"ADX Web Components\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet Name = tostring(parse_json('{_adx_wc_detail}').Name);\\\\r\\\\nlet Version = tostring(parse_json('{_adx_wc_detail}').Version);\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|where AssetLastSeen {_adx_lastseen:query} and WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|where WebComponentName == Name and WebComponentVersion == Version\\\\r\\\\n|extend Category = WebComponentCategory, Name, Version\\\\r\\\\n|project-keep AssetName,Name,Version,Category,AssetLastSeen\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Investigate WebComponent\",\"noDataMessage\":\"Select a Web Component to find associated assets\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"rowLimit\":2000,\"filter\":true}},\"customWidth\":\"60\",\"name\":\"ADX WebComponent to Asset\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX Workspace Summary\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Workspace Summary\",\"expandable\":true,\"expanded\":true,\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|summarize Count=count() by AssetType_s\",\"size\":4,\"showAnalytics\":true,\"title\":\"Asset Types\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"AssetType_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"size\":\"auto\"}},\"customWidth\":\"83\",\"name\":\"LA Asset Types\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|extend TotalCount = 'Total'\\r\\n|summarize Total=count() by TotalCount\",\"size\":4,\"showAnalytics\":true,\"title\":\"Asset Count\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"TotalCount\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Total\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":false,\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true,\"sortOrderField\":2,\"size\":\"auto\"}},\"customWidth\":\"17\",\"name\":\"LA Asset Count\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|summarize Count=count() by AssetType_s,SnapshotDateTime_t\",\"size\":0,\"aggregation\":5,\"showAnnotations\":true,\"showAnalytics\":true,\"title\":\"Asset Types Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"timechart\",\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AssetType\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}}},\"customWidth\":\"60\",\"name\":\"LA Asset Types Over Time\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmIpAddressAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where isnotempty(Locations_s)\\r\\n|union kind=inner (EasmHostAsset_CL | where WorkspaceName_s == workspace | where SnapshotDateTime_t == '{_la_snapshot}' | where isnotempty(Locations_s))\\r\\n|extend Locations_j = parse_json(Locations_s)\\r\\n|project-keep Locations_j,AssetName_s\\r\\n|mv-expand Locations_j\\r\\n|extend Region = tostring(Locations_j.Region), City = tostring(Locations_j.City), Latitude = toreal(Locations_j.Latitude), Longitude = toreal(Locations_j.Longitude), LocationLastSeen = todatetime(Locations_j.LastSeen), LocationFirstSeen = todatetime(Locations_j.FirstSeen)\\r\\n|where isnotempty(Latitude) and isnotempty(Longitude) and isnotempty(Region) and isnotempty(City)\\r\\n|project-keep AssetName_s,Region,City,Latitude,Longitude,LocationFirstSeen,LocationLastSeen\\r\\n|summarize hint.strategy=shuffle arg_max(LocationLastSeen, *) by AssetName_s,Region,City,Latitude,Longitude\",\"size\":0,\"showAnalytics\":true,\"title\":\"Asset Locations\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"map\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Region\",\"formatter\":1},\"subtitleContent\":{\"columnMatch\":\"City\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"}},\"showBorder\":false,\"sortCriteriaField\":\"Count\",\"sortOrderField\":2,\"size\":\"auto\"},\"mapSettings\":{\"locInfo\":\"LatLong\",\"locInfoColumn\":\"Region\",\"latitude\":\"Latitude\",\"longitude\":\"Longitude\",\"sizeSettings\":\"Latitude\",\"sizeAggregation\":\"Count\",\"opacity\":0.9,\"labelSettings\":\"City\",\"legendMetric\":\"City\",\"numberOfMetrics\":20,\"legendAggregation\":\"Count\",\"itemColorSettings\":{\"nodeColorField\":\"Latitude\",\"colorAggregation\":\"Count\",\"type\":\"heatmap\",\"heatmapPalette\":\"categorical\",\"heatmapMin\":5}}},\"customWidth\":\"40\",\"name\":\"LA Asset Locations\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"92020e51-938f-4494-91af-80caea4acaff\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_port_summary\",\"label\":\"Ports Summary\",\"type\":10,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"By System\\\",\\\"By Port\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":null},{\"id\":\"caf51a2e-92ce-4823-bec8-3b9166b5ea05\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_system_type\",\"label\":\"Ports System Types\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"All\\\",\\\"IPs Only\\\",\\\"Hosts Only\\\"]\",\"value\":\"All\"},{\"id\":\"d27e6b5c-43cc-434f-9bf8-0eb1035be4d2\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_has_banner\",\"label\":\"Has Banner?\",\"type\":10,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"Yes\\\"]\",\"value\":null},{\"id\":\"1dc9af90-127b-43cb-a525-ee806e11ae8f\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_port_sort\",\"label\":\"Ports Sort\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"value\":\"asc\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"LA Port Summary\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nunion isfuzzy=true (\\r\\n    EasmHostAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmHostAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = todouble(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source, PortLastSeen\\r\\n    ),\\r\\n    (\\r\\n    EasmIpAddressAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmIpAddressAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = todouble(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source, PortLastSeen\\r\\n    )\\r\\n|extend Keep = case('{_la_system_type}' == 'IPs Only', 'EasmIpAddressAsset_CL', '{_la_system_type}' == 'Hosts Only', 'EasmHostAsset_CL', 'EasmHostAsset_CL,EasmIpAddressAsset_CL')\\r\\n|where Keep has Source\\r\\n|sort by System {_la_port_sort}\\r\\n|project-away Source,Keep\\r\\n//|summarize AllPorts = make_set(Port) by System\\r\\n//|summarize AllSystems = make_set(System) by Port\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportParameterName\":\"_la_port_to_assetlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"System\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"25ch\"}}],\"rowLimit\":5000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_la_port_summary\",\"comparison\":\"isNotEqualTo\",\"value\":\"By System\"},{\"parameterName\":\"_la_port_summary\",\"comparison\":\"isNotEqualTo\",\"value\":\"By Port\"},{\"parameterName\":\"_la_has_banner\",\"comparison\":\"isNotEqualTo\",\"value\":\"Yes\"}],\"name\":\"LA All Ports_no groupBy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nunion isfuzzy=true (\\r\\n    EasmHostAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmHostAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = todouble(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source, PortLastSeen\\r\\n    ),\\r\\n    (\\r\\n    EasmIpAddressAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmIpAddressAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = todouble(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source, PortLastSeen\\r\\n    )\\r\\n|extend Keep = case('{_la_system_type}' == 'IPs Only', 'EasmIpAddressAsset_CL', '{_la_system_type}' == 'Hosts Only', 'EasmHostAsset_CL', 'EasmHostAsset_CL,EasmIpAddressAsset_CL')\\r\\n|where Keep has Source\\r\\n|join (EasmAssetBanner_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where BannerLastSeen_t {_la_lastseen:query}\\r\\n    |project-keep AssetName_s,Port_d\\r\\n) on $left.System == $right.AssetName_s, $left.Port == $right.Port_d\\r\\n|sort by System {_la_port_sort}\\r\\n|project-away Source,Keep,AssetName_s,Port_d\\r\\n//|summarize AllPorts = make_set(Port) by System\\r\\n//|summarize AllSystems = make_set(System) by Port\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportParameterName\":\"_la_port_to_assetlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"System\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"25ch\"}}],\"rowLimit\":5000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_la_port_summary\",\"comparison\":\"isNotEqualTo\",\"value\":\"By System\"},{\"parameterName\":\"_la_port_summary\",\"comparison\":\"isNotEqualTo\",\"value\":\"By Port\"},{\"parameterName\":\"_la_has_banner\",\"comparison\":\"isEqualTo\",\"value\":\"Yes\"}],\"name\":\"LA All Ports_no groupBy_hasBanner\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nunion isfuzzy=true (\\r\\n    EasmHostAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmHostAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = toint(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source\\r\\n    ),\\r\\n    (\\r\\n    EasmIpAddressAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmIpAddressAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = toint(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source\\r\\n    )\\r\\n|extend Keep = case('{_la_system_type}' == 'IPs Only', 'EasmIpAddressAsset_CL', '{_la_system_type}' == 'Hosts Only', 'EasmHostAsset_CL', 'EasmHostAsset_CL,EasmIpAddressAsset_CL')\\r\\n|where Keep has Source\\r\\n|summarize AllPorts = make_set(Port) by System\\r\\n//|summarize AllSystems = make_set(System) by Port\\r\\n|sort by System {_la_port_sort}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportParameterName\":\"_la_port_to_assetlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"System\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}}],\"rowLimit\":5000,\"filter\":true},\"sortBy\":[],\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_la_port_summary\",\"comparison\":\"isEqualTo\",\"value\":\"By System\"},{\"parameterName\":\"_la_has_banner\",\"comparison\":\"isNotEqualTo\",\"value\":\"Yes\"}],\"name\":\"LA All Ports_groupBy System\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nunion isfuzzy=true (\\r\\n    EasmHostAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmHostAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = todouble(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source\\r\\n    ),\\r\\n    (\\r\\n    EasmIpAddressAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmIpAddressAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = todouble(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source\\r\\n    )\\r\\n|extend Keep = case('{_la_system_type}' == 'IPs Only', 'EasmIpAddressAsset_CL', '{_la_system_type}' == 'Hosts Only', 'EasmHostAsset_CL', 'EasmHostAsset_CL,EasmIpAddressAsset_CL')\\r\\n|where Keep has Source\\r\\n|join (EasmAssetBanner_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where BannerLastSeen_t {_la_lastseen:query}\\r\\n    |project-keep AssetName_s,Port_d\\r\\n) on $left.System == $right.AssetName_s, $left.Port == $right.Port_d\\r\\n|summarize AllPorts = make_set(Port) by System\\r\\n//|summarize AllSystems = make_set(System) by Port\\r\\n|sort by System {_la_port_sort}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportParameterName\":\"_la_port_to_assetlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"System\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}}],\"rowLimit\":5000,\"filter\":true},\"sortBy\":[],\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_la_port_summary\",\"comparison\":\"isEqualTo\",\"value\":\"By System\"},{\"parameterName\":\"_la_has_banner\",\"comparison\":\"isEqualTo\",\"value\":\"Yes\"}],\"name\":\"LA All Ports_groupBy System_hasBanner\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nunion isfuzzy=true (\\r\\n    EasmHostAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmHostAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = toint(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source\\r\\n    ),\\r\\n    (\\r\\n    EasmIpAddressAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmIpAddressAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = toint(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source\\r\\n    )\\r\\n|extend Keep = case('{_la_system_type}' == 'IPs Only', 'EasmIpAddressAsset_CL', '{_la_system_type}' == 'Hosts Only', 'EasmHostAsset_CL', 'EasmHostAsset_CL,EasmIpAddressAsset_CL')\\r\\n|where Keep has Source\\r\\n//|summarize AllPorts = make_set(Port) by System\\r\\n|summarize AllSystems = make_set(System) by Port\\r\\n|sort by Port {_la_port_sort}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportParameterName\":\"_la_port_to_portlookup\",\"exportDefaultValue\":\"{\\\"Port\\\":-1,\\\"AllSystems\\\":[]}\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":5000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_la_port_summary\",\"comparison\":\"isEqualTo\",\"value\":\"By Port\"},{\"parameterName\":\"_la_has_banner\",\"comparison\":\"isNotEqualTo\",\"value\":\"Yes\"}],\"name\":\"LA All Ports_groupBy Port\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nunion isfuzzy=true (\\r\\n    EasmHostAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmHostAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = todouble(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source\\r\\n    ),\\r\\n    (\\r\\n    EasmIpAddressAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmIpAddressAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = todouble(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source\\r\\n    )\\r\\n|extend Keep = case('{_la_system_type}' == 'IPs Only', 'EasmIpAddressAsset_CL', '{_la_system_type}' == 'Hosts Only', 'EasmHostAsset_CL', 'EasmHostAsset_CL,EasmIpAddressAsset_CL')\\r\\n|where Keep has Source\\r\\n|join (EasmAssetBanner_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where BannerLastSeen_t {_la_lastseen:query}\\r\\n    |project-keep AssetName_s,Port_d\\r\\n) on $left.System == $right.AssetName_s, $left.Port == $right.Port_d\\r\\n//|summarize AllPorts = make_set(Port) by System\\r\\n|summarize AllSystems = make_set(System) by Port\\r\\n|sort by Port {_la_port_sort}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportParameterName\":\"_la_port_to_portlookup\",\"exportDefaultValue\":\"{\\\"Port\\\":-1,\\\"AllSystems\\\":[]}\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":5000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_la_port_summary\",\"comparison\":\"isEqualTo\",\"value\":\"By Port\"},{\"parameterName\":\"_la_has_banner\",\"comparison\":\"isEqualTo\",\"value\":\"Yes\"}],\"name\":\"LA All Ports_groupBy Port_hasBanner\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet asset_name = tostring(parse_json('{_la_port_to_assetlookup}').System);\\r\\nEasmAssetBanner_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where AssetName_s == asset_name\\r\\n|where BannerLastSeen_t {_la_lastseen:query}\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by Port_d,ScanType_s\\r\\n|project-keep AssetName_s, Port_d, ScanType_s, Banner*\\r\\n|project-reorder AssetName_s,Port_d,ScanType_s,Banner_s\\r\\n|sort by Port_d {_la_port_sort}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Asset Banners\",\"noDataMessage\":\"No Banner information found. Select a (different) row from All Ports\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":5000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"65\",\"conditionalVisibility\":{\"parameterName\":\"_la_port_to_portlookup\",\"comparison\":\"isEqualTo\"},\"name\":\"LA Asset Banners by System\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet port_num = replace_regex('{_la_port_to_portlookup}', @'.+Port\\\":(\\\\d+).+', @'\\\\1');\\r\\nEasmAssetBanner_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where Port_d == port_num\\r\\n|where BannerLastSeen_t {_la_lastseen:query}\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetName_s,ScanType_s\\r\\n|project-keep AssetName_s, Port_d, ScanType_s, Banner*\\r\\n|project-reorder AssetName_s,Port_d,ScanType_s,Banner_s\\r\\n|sort by AssetName_s {_la_port_sort}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Asset Banners\",\"noDataMessage\":\"No Banner information found. Select a (different) row from All Ports\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":5000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"65\",\"conditionalVisibility\":{\"parameterName\":\"_la_port_to_assetlookup\",\"comparison\":\"isEqualTo\"},\"name\":\"LA Asset Banners by Port\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"df71056a-a50d-423b-82ab-204948cebc96\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_wc_sort\",\"label\":\"Sort Web Component\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"asc\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"LA Web Components\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where AssetLastSeen_t {_la_lastseen:query} and WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|extend Name = WebComponentName_s, Version = WebComponentVersion_s\\r\\n|project-keep Name,Version\\r\\n|summarize Count=count() by Name,Version\\r\\n|sort by Count {_la_wc_sort}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Web Components\",\"showRefreshButton\":true,\"exportParameterName\":\"_la_wc_detail\",\"exportDefaultValue\":\"{\\\"Name\\\":\\\"\\\",\\\"Version\\\":\\\"\\\",\\\"Category\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"$gen_group\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}},{\"columnMatch\":\"Group\",\"formatter\":1,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}},{\"columnMatch\":\"Name\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"25ch\"}},{\"columnMatch\":\"Version\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"11ch\"}},{\"columnMatch\":\"$gen_group\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}}],\"rowLimit\":5000,\"filter\":true,\"hierarchySettings\":{\"treeType\":1,\"groupBy\":[\"Name\"],\"expandTopLevel\":true}}},\"customWidth\":\"40\",\"name\":\"LA Web Components\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet Name = tostring(parse_json('{_la_wc_detail}').Name);\\r\\nlet Version = tostring(parse_json('{_la_wc_detail}').Version);\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where AssetLastSeen_t {_la_lastseen:query} and WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|where WebComponentName_s == Name and WebComponentVersion_s == Version\\r\\n|extend Category = WebComponentCategory_s, Name, Version\\r\\n|project-keep AssetName_s,Name,Version,Category,AssetLastSeen_t\",\"size\":0,\"showAnalytics\":true,\"title\":\"Investigate WebComponent\",\"noDataMessage\":\"Select a Web Component to find associated assets\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"rowLimit\":2000,\"filter\":true}},\"customWidth\":\"60\",\"name\":\"LA WebComponent to Asset\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA Workspace Summary\",\"styleSettings\":{\"showBorder\":true}},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"dba28c6d-0c5a-4440-b895-bceb0966dcca\",\"cellValue\":\"ADXClusterParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu ||\",\"style\":\"primary\"},{\"id\":\"aa0adad3-0cff-4cba-b80d-dda01f4fefbb\",\"cellValue\":\"ADX Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"267d0e4e-0a7a-4db6-bf9f-ca4bd2a2e77a\",\"cellValue\":\"ADX Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"438a2b14-c3f1-4e98-9790-1f9eefdee917\",\"cellValue\":\"ADX CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"c57166f9-ab59-4163-b233-522cc9b98283\",\"cellValue\":\"ADX Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"c5fcb84f-9ea8-4eea-a95d-2bcf925e63c6\",\"cellValue\":\"ADX IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"59577e59-d477-4307-98e2-fd7eeff6d570\",\"cellValue\":\"ADX Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"c5c8d9d7-236a-48d3-b67d-afa7823abd76\",\"cellValue\":\"ADX SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"aa8d30ab-8c4c-4d39-bde4-9de46c7b1814\",\"cellValue\":\"ADX Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX Navigation Menu_under Summary\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"84a56309-6b11-4037-93a9-eb12fed553c2\",\"cellValue\":\"LAWorkspaceParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu  ||\",\"style\":\"primary\"},{\"id\":\"f58f424f-30d1-44c3-b975-95ae9411b293\",\"cellValue\":\"LA Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"8f4fff15-4ba2-4bb2-9b57-c08bb110ca5b\",\"cellValue\":\"LA Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"586344bb-82c3-4235-abe6-143342382eea\",\"cellValue\":\"LA CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"a1926b8c-e7fd-468d-a23d-f5d849037420\",\"cellValue\":\"LA Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"8cf3f17a-6e94-4b0d-b599-8227dd55a7c0\",\"cellValue\":\"LA IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"1339a9c0-b7d1-44cb-a137-debf0172828c\",\"cellValue\":\"LA Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"2fe787da-8385-4b24-95be-8f5cc4845704\",\"cellValue\":\"LA SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"fbad9993-e68c-4cc5-9185-69dfa08280ac\",\"cellValue\":\"LA Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA Navigation Menu_under Summary\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Risk Findings\",\"expandable\":true,\"expanded\":true,\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmRisk\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n|where CategoryName startswith_cs 'High'\\\\r\\\\n|extend Priority = 'High'\\\\r\\\\n|project-keep Priority,MetricDisplayName,SnapshotDateTime,AssetName\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by Priority,MetricDisplayName,AssetName\\\\r\\\\n|summarize Count=count() by Priority,MetricDisplayName\\\\r\\\\n|order by Count desc \\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"High Risk Findings\",\"showRefreshButton\":true,\"exportFieldName\":\"MetricDisplayName\",\"exportParameterName\":\"_adx_risk_finding_high\",\"exportDefaultValue\":\"xyz\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Priority\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}},{\"columnMatch\":\"MetricDisplayName\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"55ch\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}}],\"filter\":true},\"sortBy\":[]},\"customWidth\":\"33\",\"name\":\"ADX High Risk Findings\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmRisk\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n|where CategoryName startswith_cs 'Medium'\\\\r\\\\n|extend Priority = 'Medium'\\\\r\\\\n|project-keep Priority,MetricDisplayName,SnapshotDateTime,AssetName\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by Priority,MetricDisplayName,AssetName\\\\r\\\\n|summarize Count=count() by Priority,MetricDisplayName\\\\r\\\\n|sort by Count desc \\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"Medium Risk Findings\",\"showRefreshButton\":true,\"exportFieldName\":\"MetricDisplayName\",\"exportParameterName\":\"_adx_risk_finding_med\",\"exportDefaultValue\":\"xyz\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Priority\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}},{\"columnMatch\":\"MetricDisplayName\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"55ch\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}}],\"filter\":true,\"sortBy\":[{\"itemKey\":\"Count\",\"sortOrder\":2}]},\"sortBy\":[{\"itemKey\":\"Count\",\"sortOrder\":2}]},\"customWidth\":\"33\",\"name\":\"ADX Medium Risk Findings\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmRisk\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n|where CategoryName startswith_cs 'Low'\\\\r\\\\n|extend Priority = 'Low'\\\\r\\\\n|project-keep Priority,MetricDisplayName,SnapshotDateTime,AssetName\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by Priority,MetricDisplayName,AssetName\\\\r\\\\n|summarize Count=count() by Priority,MetricDisplayName\\\\r\\\\n|order by Count desc \\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"Low Risk Findings\",\"showRefreshButton\":true,\"exportFieldName\":\"MetricDisplayName\",\"exportParameterName\":\"_adx_risk_finding_low\",\"exportDefaultValue\":\"xyz\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Priority\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}},{\"columnMatch\":\"MetricDisplayName\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"55ch\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}}],\"filter\":true}},\"customWidth\":\"33\",\"name\":\"ADX Low Risk Findings\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet metric_name_high = '{_adx_risk_finding_high}';\\\\r\\\\nlet metric_name_med = '{_adx_risk_finding_med}';\\\\r\\\\nlet metric_name_low = '{_adx_risk_finding_low}';\\\\r\\\\nEasmRisk\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n|where MetricDisplayName in (metric_name_high,metric_name_med,metric_name_low)\\\\r\\\\n|extend Priority =  case(CategoryName startswith_cs 'High','High',CategoryName startswith_cs 'Medium','Medium','Low')\\\\r\\\\n|extend PrioNum = case(Priority == 'High',1,Priority == 'Medium',2,3)\\\\r\\\\n|project-keep AssetName,MetricDisplayName,AssetLastSeen,AssetDescription,Priority,PrioNum\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(AssetLastSeen, *) by AssetName,MetricDisplayName,AssetDescription,Priority,PrioNum\\\\r\\\\n|project-reorder Priority,AssetName\\\\r\\\\n|sort by PrioNum asc\\\\r\\\\n|project-away PrioNum\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"Risk Details\",\"noDataMessage\":\"No risk findings found. Select a risk finding above\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"filter\":true}},\"name\":\"ADX Risk Details\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX Risk Findings\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Risk Findings\",\"expandable\":true,\"expanded\":true,\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmRisk_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where AssetLastSeen_t {_la_lastseen:query}\\r\\n|where CategoryName_s startswith_cs 'High'\\r\\n|extend Priority = 'High'\\r\\n|project-keep Priority,MetricDisplayName_s,SnapshotDateTime_t,AssetName_s\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by Priority,MetricDisplayName_s,AssetName_s\\r\\n|summarize Count=count() by Priority,MetricDisplayName_s\\r\\n|order by Count desc \",\"size\":1,\"showAnalytics\":true,\"title\":\"High Risk Findings\",\"showRefreshButton\":true,\"exportFieldName\":\"MetricDisplayName_s\",\"exportParameterName\":\"_la_risk_finding_high\",\"exportDefaultValue\":\"xyz\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Priority\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}},{\"columnMatch\":\"MetricDisplayName\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"55ch\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}}],\"filter\":true},\"sortBy\":[]},\"customWidth\":\"33\",\"name\":\"LA High Risk Findings\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmRisk_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where AssetLastSeen_t {_la_lastseen:query}\\r\\n|where CategoryName_s startswith_cs 'Medium'\\r\\n|extend Priority = 'Medium'\\r\\n|project-keep Priority,MetricDisplayName_s,SnapshotDateTime_t,AssetName_s\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by Priority,MetricDisplayName_s,AssetName_s\\r\\n|summarize Count=count() by Priority,MetricDisplayName_s\\r\\n|order by Count desc \",\"size\":1,\"showAnalytics\":true,\"title\":\"High Risk Findings\",\"showRefreshButton\":true,\"exportFieldName\":\"MetricDisplayName_s\",\"exportParameterName\":\"_la_risk_finding_medium\",\"exportDefaultValue\":\"xyz\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Priority\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}},{\"columnMatch\":\"MetricDisplayName\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"55ch\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}}],\"filter\":true},\"sortBy\":[]},\"customWidth\":\"33\",\"name\":\"LA Medium Risk Findings\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmRisk_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where AssetLastSeen_t {_la_lastseen:query}\\r\\n|where CategoryName_s startswith_cs 'Low'\\r\\n|extend Priority = 'Low'\\r\\n|project-keep Priority,MetricDisplayName_s,SnapshotDateTime_t,AssetName_s\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by Priority,MetricDisplayName_s,AssetName_s\\r\\n|summarize Count=count() by Priority,MetricDisplayName_s\\r\\n|order by Count desc \",\"size\":1,\"showAnalytics\":true,\"title\":\"High Risk Findings\",\"showRefreshButton\":true,\"exportFieldName\":\"MetricDisplayName_s\",\"exportParameterName\":\"_la_risk_finding_low\",\"exportDefaultValue\":\"xyz\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Priority\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}},{\"columnMatch\":\"MetricDisplayName\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"55ch\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}}],\"filter\":true},\"sortBy\":[]},\"customWidth\":\"33\",\"name\":\"LA Low Risk Findings\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet metric_name_high = '{_la_risk_finding_high}';\\r\\nlet metric_name_med = '{_la_risk_finding_medium}';\\r\\nlet metric_name_low = '{_la_risk_finding_low}';\\r\\nEasmRisk_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where AssetLastSeen_t {_la_lastseen:query}\\r\\n|where MetricDisplayName_s in (metric_name_high,metric_name_med,metric_name_low)\\r\\n|extend Priority =  case(CategoryName_s startswith_cs 'High','High',CategoryName_s startswith_cs 'Medium','Medium','Low')\\r\\n|extend PrioNum = case(Priority == 'High',1,Priority == 'Medium',2,3)\\r\\n|project-keep AssetName_s,MetricDisplayName_s,AssetLastSeen_t,AssetDescription_s,Priority,PrioNum\\r\\n|summarize hint.strategy=shuffle arg_max(AssetLastSeen_t, *) by AssetName_s,MetricDisplayName_s,AssetDescription_s,Priority,PrioNum\\r\\n|project-reorder Priority,AssetName_s\\r\\n|sort by PrioNum asc\\r\\n|project-away PrioNum\",\"size\":1,\"showAnalytics\":true,\"title\":\"Risk Details\",\"noDataMessage\":\"No risk findings found. Select a risk finding above\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"filter\":true}},\"name\":\"LA Risk Details\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA Risk Findings\",\"styleSettings\":{\"showBorder\":true}},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"1eb92060-81b3-4422-ac92-3c11bd5b9681\",\"cellValue\":\"ADXClusterParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu ||\",\"style\":\"primary\"},{\"id\":\"4e45604d-fafc-408e-a06b-75607a8b9353\",\"cellValue\":\"ADX Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"8b03ccf5-9d69-4743-8f1f-61943ca65501\",\"cellValue\":\"ADX Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"ff9f4b98-a8cc-4b49-8c91-a8ccca29c73e\",\"cellValue\":\"ADX CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"9883954a-f415-4343-9238-5a41971072bc\",\"cellValue\":\"ADX Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"60ae79a9-a868-4dd3-8f15-8d2019cef8b2\",\"cellValue\":\"ADX IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"cd3cc176-5e32-4fa9-b9cb-445261c7dbd2\",\"cellValue\":\"ADX Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"e50b0572-060f-4e78-8a44-ca7e51491823\",\"cellValue\":\"ADX SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"19230b89-3f56-4afd-b04f-2f19b3b8a975\",\"cellValue\":\"ADX Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX Navigation Menu_under Risk Findings\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"62a63930-80a1-4ecc-a4bf-0c42fcf8c063\",\"cellValue\":\"LAWorkspaceParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu  ||\",\"style\":\"primary\"},{\"id\":\"b141f70f-3717-42c3-b951-5bc8dee8ee0a\",\"cellValue\":\"LA Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"5d173539-5044-4ad6-8a0d-11f74c1c8b8f\",\"cellValue\":\"LA Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"15fd630a-e057-4a89-9813-a35e017c068b\",\"cellValue\":\"LA CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"63687a45-2b51-405d-9693-6fcdafda8510\",\"cellValue\":\"LA Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"77f51a84-907b-48e7-a7d6-22b956933692\",\"cellValue\":\"LA IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"8613e848-2eb4-4261-ab14-ece1e6dd1c47\",\"cellValue\":\"LA Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"07fbc933-4064-4d20-8cec-f14054c9bd7e\",\"cellValue\":\"LA SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"be1ad068-afec-4954-a3e0-1ef922537e73\",\"cellValue\":\"LA Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA Navigation Menu_under Risk Findings\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"CVEs\",\"expandable\":true,\"expanded\":true,\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"37b59c82-360f-4114-a0e2-493af4089ff5\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_cvssscore\",\"label\":\"CVSS Score\",\"type\":2,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"1\\\",\\\"2\\\",\\\"3\\\",\\\"4\\\",\\\"5\\\",\\\"6\\\",\\\"7\\\",\\\"8\\\",\\\"9\\\",\\\"10\\\"]\",\"value\":\"7\"},{\"id\":\"e730581e-d227-4a03-a0b0-f6e4ca5dd945\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_cvss3score\",\"label\":\"CVSS 3 Score\",\"type\":2,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"1\\\",\\\"2\\\",\\\"3\\\",\\\"4\\\",\\\"5\\\",\\\"6\\\",\\\"7\\\",\\\"8\\\",\\\"9\\\",\\\"10\\\"]\",\"value\":\"7\"},{\"id\":\"6ce03701-994f-4699-8a0b-2121af3d303a\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_group_by\",\"label\":\"Group By\",\"type\":10,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"AssetName\\\",\\\"Cve\\\",\\\"WebComponent\\\"]\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"CVE Asset Score Filters\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet cvssscore = {_adx_cvssscore};\\\\r\\\\nlet cvss3score = {_adx_cvss3score};\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|where array_length(WebComponentCves) != 0\\\\r\\\\n|where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|mv-expand WebComponentCves\\\\r\\\\n|extend Cve = tostring(WebComponentCves.Cve), Cwe = tostring(WebComponentCves.Cwe), CvssScore = tolong(WebComponentCves.CvssScore), Cvss3Score = toreal(WebComponentCves.Cvss3Score)\\\\r\\\\n|where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\\\r\\\\n|project-keep WebComponentCategory,WebComponentName,WebComponentVersion,Cve,Cwe,CvssScore,Cvss3Score,AssetName,WebComponentLastSeen\\\\r\\\\n|project-reorder AssetName,WebComponentName,WebComponentVersion,Cve,CvssScore,Cvss3Score,Cwe\\\\r\\\\n|sort by WebComponentLastSeen desc\\\\r\\\\n//|summarize Asset = make_list(pack_all()) by AssetName\\\\r\\\\n//|summarize CVE = make_list(pack_all()) by Cve\\\\r\\\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"Assets With CVEs\",\"showRefreshButton\":true,\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibilities\":[{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"Cve\"},{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"WebComponent\"},{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"AssetName\"}],\"name\":\"ADX Assets With CVEs_no groupBy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet cvssscore = {_adx_cvssscore};\\\\r\\\\nlet cvss3score = {_adx_cvss3score};\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|where array_length(WebComponentCves) != 0\\\\r\\\\n|where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|mv-expand WebComponentCves\\\\r\\\\n|extend Cve = tostring(WebComponentCves.Cve), Cwe = tostring(WebComponentCves.Cwe), CvssScore = tolong(WebComponentCves.CvssScore), Cvss3Score = toreal(WebComponentCves.Cvss3Score)\\\\r\\\\n|where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\\\r\\\\n|project-keep WebComponentCategory,WebComponentName,WebComponentVersion,Cve,Cwe,CvssScore,Cvss3Score,AssetName,WebComponentLastSeen\\\\r\\\\n//|project-reorder AssetName,WebComponentName,WebComponentVersion,Cve,CvssScore,Cvss3Score,Cwe\\\\r\\\\n//|sort by WebComponentLastSeen desc\\\\r\\\\n|summarize Asset = make_list(pack_all()) by AssetName\\\\r\\\\n//|summarize CVE = make_list(pack_all()) by Cve\\\\r\\\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"Assets With CVEs\",\"showRefreshButton\":true,\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"AssetName\"},\"name\":\"ADX Assets With CVEs_groupBy AssetName\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet cvssscore = {_adx_cvssscore};\\\\r\\\\nlet cvss3score = {_adx_cvss3score};\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|where array_length(WebComponentCves) != 0\\\\r\\\\n|where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|mv-expand WebComponentCves\\\\r\\\\n|extend Cve = tostring(WebComponentCves.Cve), Cwe = tostring(WebComponentCves.Cwe), CvssScore = tolong(WebComponentCves.CvssScore), Cvss3Score = toreal(WebComponentCves.Cvss3Score)\\\\r\\\\n|where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\\\r\\\\n|project-keep WebComponentCategory,WebComponentName,WebComponentVersion,Cve,Cwe,CvssScore,Cvss3Score,AssetName,WebComponentLastSeen\\\\r\\\\n//|project-reorder AssetName,WebComponentName,WebComponentVersion,Cve,CvssScore,Cvss3Score,Cwe\\\\r\\\\n//|sort by WebComponentLastSeen desc\\\\r\\\\n//|summarize Asset = make_list(pack_all()) by AssetName\\\\r\\\\n|summarize CVE = make_list(pack_all()) by Cve\\\\r\\\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"Assets With CVEs\",\"showRefreshButton\":true,\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"Cve\"},\"name\":\"ADX Assets With CVEs_groupBy Cve\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet cvssscore = {_adx_cvssscore};\\\\r\\\\nlet cvss3score = {_adx_cvss3score};\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|where array_length(WebComponentCves) != 0\\\\r\\\\n|where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|mv-expand WebComponentCves\\\\r\\\\n|extend Cve = tostring(WebComponentCves.Cve), Cwe = tostring(WebComponentCves.Cwe), CvssScore = tolong(WebComponentCves.CvssScore), Cvss3Score = toreal(WebComponentCves.Cvss3Score)\\\\r\\\\n|where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\\\r\\\\n|project-keep WebComponentCategory,WebComponentName,WebComponentVersion,Cve,Cwe,CvssScore,Cvss3Score,AssetName,WebComponentLastSeen\\\\r\\\\n//|project-reorder AssetName,WebComponentName,WebComponentVersion,Cve,CvssScore,Cvss3Score,Cwe\\\\r\\\\n//|sort by WebComponentLastSeen desc\\\\r\\\\n//|summarize Asset = make_list(pack_all()) by AssetName\\\\r\\\\n//|summarize CVE = make_list(pack_all()) by Cve\\\\r\\\\n|summarize WebComponent = make_list(pack_all()) by WebComponentName,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"Assets With CVEs\",\"showRefreshButton\":true,\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"WebComponent\"},\"name\":\"ADX Assets With CVEs_groupBy WebComponentName\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet cvssscore = {_adx_cvssscore};\\\\r\\\\nlet cvss3score = {_adx_cvss3score};\\\\r\\\\nlet Cves = externaldata (CveId: string )\\\\r\\\\n[\\\\r\\\\n    h@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\\\\r\\\\n]\\\\r\\\\nwith (format='csv', ingestionMapping='[{\\\\\\\"Column\\\\\\\":\\\\\\\"CveId\\\\\\\",\\\\\\\"Properties\\\\\\\":{\\\\\\\"Ordinal\\\\\\\":\\\\\\\"0\\\\\\\"}}]')\\\\r\\\\n|where CveId != 'cveID';\\\\r\\\\nCves\\\\r\\\\n| join kind=rightsemi (EasmAssetWebComponent\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where array_length(WebComponentCves) != 0\\\\r\\\\n    |where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n    |mv-expand WebComponentCves\\\\r\\\\n    |extend Cve = tostring(WebComponentCves.Cve), Cwe = tostring(WebComponentCves.Cwe), CvssScore = tolong(WebComponentCves.CvssScore), Cvss3Score = toreal(WebComponentCves.Cvss3Score)\\\\r\\\\n    |where (CvssScore >= cvssscore or Cvss3Score >= cvss3score) \\\\r\\\\n    |project-keep WebComponentCategory,WebComponentName,WebComponentVersion,Cve,Cwe,CvssScore,Cvss3Score,AssetName,WebComponentLastSeen\\\\r\\\\n) on $left.CveId == $right.Cve\\\\r\\\\n|project-reorder AssetName,WebComponentName,WebComponentVersion,Cve,CvssScore,Cvss3Score,Cwe\\\\r\\\\n|sort by WebComponentLastSeen desc\\\\r\\\\n//|summarize Asset = make_list(pack_all()) by AssetName\\\\r\\\\n//|summarize CVE = make_list(pack_all()) by Cve\\\\r\\\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"CISA Known Exploited Vulnerabilities\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibilities\":[{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"AssetName\"},{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"Cve\"},{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"WebComponent\"}],\"name\":\"ADX CISA Known Exploited Vulnerabilities_no groupBy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet cvssscore = {_adx_cvssscore};\\\\r\\\\nlet cvss3score = {_adx_cvss3score};\\\\r\\\\nlet Cves = externaldata (CveId: string )\\\\r\\\\n[\\\\r\\\\n    h@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\\\\r\\\\n]\\\\r\\\\nwith (format='csv', ingestionMapping='[{\\\\\\\"Column\\\\\\\":\\\\\\\"CveId\\\\\\\",\\\\\\\"Properties\\\\\\\":{\\\\\\\"Ordinal\\\\\\\":\\\\\\\"0\\\\\\\"}}]')\\\\r\\\\n|where CveId != 'cveID';\\\\r\\\\nCves\\\\r\\\\n| join kind=rightsemi (EasmAssetWebComponent\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where array_length(WebComponentCves) != 0\\\\r\\\\n    |where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n    |mv-expand WebComponentCves\\\\r\\\\n    |extend Cve = tostring(WebComponentCves.Cve), Cwe = tostring(WebComponentCves.Cwe), CvssScore = tolong(WebComponentCves.CvssScore), Cvss3Score = toreal(WebComponentCves.Cvss3Score)\\\\r\\\\n    |where (CvssScore >= cvssscore or Cvss3Score >= cvss3score) \\\\r\\\\n    |project-keep WebComponentCategory,WebComponentName,WebComponentVersion,Cve,Cwe,CvssScore,Cvss3Score,AssetName,WebComponentLastSeen\\\\r\\\\n) on $left.CveId == $right.Cve\\\\r\\\\n//|project-reorder AssetName,WebComponentName,WebComponentVersion,Cve,CvssScore,Cvss3Score,Cwe\\\\r\\\\n//|sort by WebComponentLastSeen desc\\\\r\\\\n|summarize Asset = make_list(pack_all()) by AssetName\\\\r\\\\n//|summarize CVE = make_list(pack_all()) by Cve\\\\r\\\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"CISA Known Exploited Vulnerabilities\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"AssetName\"},\"name\":\"ADX CISA Known Exploited Vulnerabilities_groupBy AssetName\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet cvssscore = {_adx_cvssscore};\\\\r\\\\nlet cvss3score = {_adx_cvss3score};\\\\r\\\\nlet Cves = externaldata (CveId: string )\\\\r\\\\n[\\\\r\\\\n    h@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\\\\r\\\\n]\\\\r\\\\nwith (format='csv', ingestionMapping='[{\\\\\\\"Column\\\\\\\":\\\\\\\"CveId\\\\\\\",\\\\\\\"Properties\\\\\\\":{\\\\\\\"Ordinal\\\\\\\":\\\\\\\"0\\\\\\\"}}]')\\\\r\\\\n|where CveId != 'cveID';\\\\r\\\\nCves\\\\r\\\\n| join kind=rightsemi (EasmAssetWebComponent\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where array_length(WebComponentCves) != 0\\\\r\\\\n    |where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n    |mv-expand WebComponentCves\\\\r\\\\n    |extend Cve = tostring(WebComponentCves.Cve), Cwe = tostring(WebComponentCves.Cwe), CvssScore = tolong(WebComponentCves.CvssScore), Cvss3Score = toreal(WebComponentCves.Cvss3Score)\\\\r\\\\n    |where (CvssScore >= cvssscore or Cvss3Score >= cvss3score) \\\\r\\\\n    |project-keep WebComponentCategory,WebComponentName,WebComponentVersion,Cve,Cwe,CvssScore,Cvss3Score,AssetName,WebComponentLastSeen\\\\r\\\\n) on $left.CveId == $right.Cve\\\\r\\\\n//|project-reorder AssetName,WebComponentName,WebComponentVersion,Cve,CvssScore,Cvss3Score,Cwe\\\\r\\\\n//|sort by WebComponentLastSeen desc\\\\r\\\\n//|summarize Asset = make_list(pack_all()) by AssetName\\\\r\\\\n|summarize CVE = make_list(pack_all()) by Cve\\\\r\\\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"CISA Known Exploited Vulnerabilities\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"Cve\"},\"name\":\"ADX CISA Known Exploited Vulnerabilities_groupBy Cve\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet cvssscore = {_adx_cvssscore};\\\\r\\\\nlet cvss3score = {_adx_cvss3score};\\\\r\\\\nlet Cves = externaldata (CveId: string )\\\\r\\\\n[\\\\r\\\\n    h@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\\\\r\\\\n]\\\\r\\\\nwith (format='csv', ingestionMapping='[{\\\\\\\"Column\\\\\\\":\\\\\\\"CveId\\\\\\\",\\\\\\\"Properties\\\\\\\":{\\\\\\\"Ordinal\\\\\\\":\\\\\\\"0\\\\\\\"}}]')\\\\r\\\\n|where CveId != 'cveID';\\\\r\\\\nCves\\\\r\\\\n| join kind=rightsemi (EasmAssetWebComponent\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where array_length(WebComponentCves) != 0\\\\r\\\\n    |where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n    |mv-expand WebComponentCves\\\\r\\\\n    |extend Cve = tostring(WebComponentCves.Cve), Cwe = tostring(WebComponentCves.Cwe), CvssScore = tolong(WebComponentCves.CvssScore), Cvss3Score = toreal(WebComponentCves.Cvss3Score)\\\\r\\\\n    |where (CvssScore >= cvssscore or Cvss3Score >= cvss3score) \\\\r\\\\n    |project-keep WebComponentCategory,WebComponentName,WebComponentVersion,Cve,Cwe,CvssScore,Cvss3Score,AssetName,WebComponentLastSeen\\\\r\\\\n) on $left.CveId == $right.Cve\\\\r\\\\n//|project-reorder AssetName,WebComponentName,WebComponentVersion,Cve,CvssScore,Cvss3Score,Cwe\\\\r\\\\n//|sort by WebComponentLastSeen desc\\\\r\\\\n//|summarize Asset = make_list(pack_all()) by AssetName\\\\r\\\\n//|summarize CVE = make_list(pack_all()) by Cve\\\\r\\\\n|summarize WebComponent = make_list(pack_all()) by WebComponentName,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"CISA Known Exploited Vulnerabilities\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"WebComponent\"},\"name\":\"ADX CISA Known Exploited Vulnerabilities_groupBy WebComponent\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX CVEs\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"CVEs\",\"expandable\":true,\"expanded\":true,\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"37b59c82-360f-4114-a0e2-493af4089ff5\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_cvssscore\",\"label\":\"CVSS Score\",\"type\":2,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"1\\\",\\\"2\\\",\\\"3\\\",\\\"4\\\",\\\"5\\\",\\\"6\\\",\\\"7\\\",\\\"8\\\",\\\"9\\\",\\\"10\\\"]\",\"value\":\"7\"},{\"id\":\"e730581e-d227-4a03-a0b0-f6e4ca5dd945\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_cvss3score\",\"label\":\"CVSS 3 Score\",\"type\":2,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"1\\\",\\\"2\\\",\\\"3\\\",\\\"4\\\",\\\"5\\\",\\\"6\\\",\\\"7\\\",\\\"8\\\",\\\"9\\\",\\\"10\\\"]\",\"value\":\"7\"},{\"id\":\"6ce03701-994f-4699-8a0b-2121af3d303a\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_group_by\",\"label\":\"Group By\",\"type\":10,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"AssetName\\\",\\\"Cve\\\",\\\"WebComponent\\\"]\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"CVE Asset Score Filters\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet cvssscore = {_la_cvssscore};\\r\\nlet cvss3score = {_la_cvss3score};\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where isnotempty(WebComponentCves_s)\\r\\n|where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|extend WebComponentCves_j = parse_json(WebComponentCves_s)\\r\\n|mv-expand WebComponentCves_j\\r\\n|extend Cve = tostring(WebComponentCves_j.Cve), Cwe = tostring(WebComponentCves_j.Cwe), CvssScore = tolong(WebComponentCves_j.CvssScore), Cvss3Score = toreal(WebComponentCves_j.Cvss3Score)\\r\\n|where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\r\\n|project-keep WebComponentCategory_s,WebComponentName_s,WebComponentVersion_s,Cve,Cwe,CvssScore,Cvss3Score,AssetName_s,WebComponentLastSeen_t\\r\\n|project-reorder AssetName_s,WebComponentName_s,WebComponentVersion_s,Cve,CvssScore,Cvss3Score,Cwe\\r\\n|sort by WebComponentLastSeen_t desc\\r\\n//|summarize Asset = make_list(pack_all()) by AssetName_s\\r\\n//|summarize CVE = make_list(pack_all()) by Cve\\r\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName_s,WebComponentVersion_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"Assets With CVEs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibilities\":[{\"parameterName\":\"_la_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"Cve\"},{\"parameterName\":\"_la_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"WebComponent\"},{\"parameterName\":\"_la_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"AssetName\"}],\"name\":\"LA Assets With CVEs_no groupBy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet cvssscore = {_la_cvssscore};\\r\\nlet cvss3score = {_la_cvss3score};\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where isnotempty(WebComponentCves_s)\\r\\n|where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|extend WebComponentCves_j = parse_json(WebComponentCves_s)\\r\\n|mv-expand WebComponentCves_j\\r\\n|extend Cve = tostring(WebComponentCves_j.Cve), Cwe = tostring(WebComponentCves_j.Cwe), CvssScore = tolong(WebComponentCves_j.CvssScore), Cvss3Score = toreal(WebComponentCves_j.Cvss3Score)\\r\\n|where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\r\\n|project-keep WebComponentCategory_s,WebComponentName_s,WebComponentVersion_s,Cve,Cwe,CvssScore,Cvss3Score,AssetName_s,WebComponentLastSeen_t\\r\\n//|project-reorder AssetName_s,WebComponentName_s,WebComponentVersion_s,Cve,CvssScore,Cvss3Score,Cwe\\r\\n//|sort by WebComponentLastSeen_t desc\\r\\n|summarize Asset = make_list(pack_all()) by AssetName_s\\r\\n//|summarize CVE = make_list(pack_all()) by Cve\\r\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName_s,WebComponentVersion_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"Assets With CVEs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true,\"sortBy\":[{\"itemKey\":\"AssetName_s\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"AssetName_s\",\"sortOrder\":1}]},\"conditionalVisibility\":{\"parameterName\":\"_la_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"AssetName\"},\"name\":\"LA Assets With CVEs_groupBy AssetName\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet cvssscore = {_la_cvssscore};\\r\\nlet cvss3score = {_la_cvss3score};\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where isnotempty(WebComponentCves_s)\\r\\n|where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|extend WebComponentCves_j = parse_json(WebComponentCves_s)\\r\\n|mv-expand WebComponentCves_j\\r\\n|extend Cve = tostring(WebComponentCves_j.Cve), Cwe = tostring(WebComponentCves_j.Cwe), CvssScore = tolong(WebComponentCves_j.CvssScore), Cvss3Score = toreal(WebComponentCves_j.Cvss3Score)\\r\\n|where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\r\\n|project-keep WebComponentCategory_s,WebComponentName_s,WebComponentVersion_s,Cve,Cwe,CvssScore,Cvss3Score,AssetName_s,WebComponentLastSeen_t\\r\\n//|project-reorder AssetName_s,WebComponentName_s,WebComponentVersion_s,Cve,CvssScore,Cvss3Score,Cwe\\r\\n//|sort by WebComponentLastSeen_t desc\\r\\n//|summarize Asset = make_list(pack_all()) by AssetName_s\\r\\n|summarize CVE = make_list(pack_all()) by Cve\\r\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName_s,WebComponentVersion_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"Assets With CVEs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true,\"sortBy\":[{\"itemKey\":\"Cve\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"Cve\",\"sortOrder\":1}]},\"conditionalVisibility\":{\"parameterName\":\"_la_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"Cve\"},\"name\":\"LA Assets With CVEs_groupBy Cve\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet cvssscore = {_la_cvssscore};\\r\\nlet cvss3score = {_la_cvss3score};\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where isnotempty(WebComponentCves_s)\\r\\n|where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|extend WebComponentCves_j = parse_json(WebComponentCves_s)\\r\\n|mv-expand WebComponentCves_j\\r\\n|extend Cve = tostring(WebComponentCves_j.Cve), Cwe = tostring(WebComponentCves_j.Cwe), CvssScore = tolong(WebComponentCves_j.CvssScore), Cvss3Score = toreal(WebComponentCves_j.Cvss3Score)\\r\\n|where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\r\\n|project-keep WebComponentCategory_s,WebComponentName_s,WebComponentVersion_s,Cve,Cwe,CvssScore,Cvss3Score,AssetName_s,WebComponentLastSeen_t\\r\\n//|project-reorder AssetName_s,WebComponentName_s,WebComponentVersion_s,Cve,CvssScore,Cvss3Score,Cwe\\r\\n//|sort by WebComponentLastSeen_t desc\\r\\n//|summarize Asset = make_list(pack_all()) by AssetName_s\\r\\n//|summarize CVE = make_list(pack_all()) by Cve\\r\\n|summarize WebComponent = make_list(pack_all()) by WebComponentName_s,WebComponentVersion_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"Assets With CVEs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_la_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"WebComponent\"},\"name\":\"LA Assets With CVEs_groupBy WebComponent\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet cvssscore = {_la_cvssscore};\\r\\nlet cvss3score = {_la_cvss3score};\\r\\nlet Cves = externaldata (CveId: string )\\r\\n[\\r\\n    h@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\\r\\n]\\r\\nwith (format='csv', ingestionMapping='[{\\\"Column\\\":\\\"CveId\\\",\\\"Properties\\\":{\\\"Ordinal\\\":\\\"0\\\"}}]')\\r\\n|where CveId != 'cveID';\\r\\nCves\\r\\n| join kind=rightsemi (EasmAssetWebComponent_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where isnotempty(WebComponentCves_s)\\r\\n    |where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n    |extend WebComponentCves_j = parse_json(WebComponentCves_s)\\r\\n    |mv-expand WebComponentCves_j\\r\\n    |extend Cve = tostring(WebComponentCves_j.Cve), Cwe = tostring(WebComponentCves_j.Cwe), CvssScore = tolong(WebComponentCves_j.CvssScore), Cvss3Score = toreal(WebComponentCves_j.Cvss3Score)\\r\\n    |where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\r\\n    |project-keep WebComponentCategory_s,WebComponentName_s,WebComponentVersion_s,Cve,Cwe,CvssScore,Cvss3Score,AssetName_s,WebComponentLastSeen_t\\r\\n) on $left.CveId == $right.Cve\\r\\n|project-reorder AssetName_s,WebComponentName_s,WebComponentVersion_s,Cve,CvssScore,Cvss3Score,Cwe\\r\\n|sort by WebComponentLastSeen_t desc\\r\\n//|summarize Asset = make_list(pack_all()) by AssetName_s\\r\\n//|summarize CVE = make_list(pack_all()) by Cve\\r\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName_s,WebComponentVersion_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"CISA Known Exploited Vulnerabilities\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibilities\":[{\"parameterName\":\"_la_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"AssetName\"},{\"parameterName\":\"_la_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"Cve\"},{\"parameterName\":\"_la_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"WebComponent\"}],\"name\":\"LA CISA Known Exploited Vulnerabilities_no groupBy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet cvssscore = {_la_cvssscore};\\r\\nlet cvss3score = {_la_cvss3score};\\r\\nlet Cves = externaldata (CveId: string )\\r\\n[\\r\\n    h@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\\r\\n]\\r\\nwith (format='csv', ingestionMapping='[{\\\"Column\\\":\\\"CveId\\\",\\\"Properties\\\":{\\\"Ordinal\\\":\\\"0\\\"}}]')\\r\\n|where CveId != 'cveID';\\r\\nCves\\r\\n| join kind=rightsemi (EasmAssetWebComponent_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where isnotempty(WebComponentCves_s)\\r\\n    |where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n    |extend WebComponentCves_j = parse_json(WebComponentCves_s)\\r\\n    |mv-expand WebComponentCves_j\\r\\n    |extend Cve = tostring(WebComponentCves_j.Cve), Cwe = tostring(WebComponentCves_j.Cwe), CvssScore = tolong(WebComponentCves_j.CvssScore), Cvss3Score = toreal(WebComponentCves_j.Cvss3Score)\\r\\n    |where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\r\\n    |project-keep WebComponentCategory_s,WebComponentName_s,WebComponentVersion_s,Cve,Cwe,CvssScore,Cvss3Score,AssetName_s,WebComponentLastSeen_t\\r\\n) on $left.CveId == $right.Cve\\r\\n//|project-reorder AssetName_s,WebComponentName_s,WebComponentVersion_s,Cve,CvssScore,Cvss3Score,Cwe\\r\\n//|sort by WebComponentLastSeen_t desc\\r\\n|summarize Asset = make_list(pack_all()) by AssetName_s\\r\\n//|summarize CVE = make_list(pack_all()) by Cve\\r\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName_s,WebComponentVersion_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"CISA Known Exploited Vulnerabilities\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_la_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"AssetName\"},\"name\":\"LA CISA Known Exploited Vulnerabilities_groupBy AssetName\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet cvssscore = {_la_cvssscore};\\r\\nlet cvss3score = {_la_cvss3score};\\r\\nlet Cves = externaldata (CveId: string )\\r\\n[\\r\\n    h@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\\r\\n]\\r\\nwith (format='csv', ingestionMapping='[{\\\"Column\\\":\\\"CveId\\\",\\\"Properties\\\":{\\\"Ordinal\\\":\\\"0\\\"}}]')\\r\\n|where CveId != 'cveID';\\r\\nCves\\r\\n| join kind=rightsemi (EasmAssetWebComponent_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where isnotempty(WebComponentCves_s)\\r\\n    |where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n    |extend WebComponentCves_j = parse_json(WebComponentCves_s)\\r\\n    |mv-expand WebComponentCves_j\\r\\n    |extend Cve = tostring(WebComponentCves_j.Cve), Cwe = tostring(WebComponentCves_j.Cwe), CvssScore = tolong(WebComponentCves_j.CvssScore), Cvss3Score = toreal(WebComponentCves_j.Cvss3Score)\\r\\n    |where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\r\\n    |project-keep WebComponentCategory_s,WebComponentName_s,WebComponentVersion_s,Cve,Cwe,CvssScore,Cvss3Score,AssetName_s,WebComponentLastSeen_t\\r\\n) on $left.CveId == $right.Cve\\r\\n//|project-reorder AssetName_s,WebComponentName_s,WebComponentVersion_s,Cve,CvssScore,Cvss3Score,Cwe\\r\\n//|sort by WebComponentLastSeen_t desc\\r\\n//|summarize Asset = make_list(pack_all()) by AssetName_s\\r\\n|summarize CVE = make_list(pack_all()) by Cve\\r\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName_s,WebComponentVersion_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"CISA Known Exploited Vulnerabilities\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_la_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"Cve\"},\"name\":\"LA CISA Known Exploited Vulnerabilities_groupBy Cve\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet cvssscore = {_la_cvssscore};\\r\\nlet cvss3score = {_la_cvss3score};\\r\\nlet Cves = externaldata (CveId: string )\\r\\n[\\r\\n    h@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\\r\\n]\\r\\nwith (format='csv', ingestionMapping='[{\\\"Column\\\":\\\"CveId\\\",\\\"Properties\\\":{\\\"Ordinal\\\":\\\"0\\\"}}]')\\r\\n|where CveId != 'cveID';\\r\\nCves\\r\\n| join kind=rightsemi (EasmAssetWebComponent_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where isnotempty(WebComponentCves_s)\\r\\n    |where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n    |extend WebComponentCves_j = parse_json(WebComponentCves_s)\\r\\n    |mv-expand WebComponentCves_j\\r\\n    |extend Cve = tostring(WebComponentCves_j.Cve), Cwe = tostring(WebComponentCves_j.Cwe), CvssScore = tolong(WebComponentCves_j.CvssScore), Cvss3Score = toreal(WebComponentCves_j.Cvss3Score)\\r\\n    |where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\r\\n    |project-keep WebComponentCategory_s,WebComponentName_s,WebComponentVersion_s,Cve,Cwe,CvssScore,Cvss3Score,AssetName_s,WebComponentLastSeen_t\\r\\n) on $left.CveId == $right.Cve\\r\\n//|project-reorder AssetName_s,WebComponentName_s,WebComponentVersion_s,Cve,CvssScore,Cvss3Score,Cwe\\r\\n//|sort by WebComponentLastSeen_t desc\\r\\n//|summarize Asset = make_list(pack_all()) by AssetName_s\\r\\n//|summarize CVE = make_list(pack_all()) by Cve\\r\\n|summarize WebComponent = make_list(pack_all()) by WebComponentName_s,WebComponentVersion_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"CISA Known Exploited Vulnerabilities\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_la_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"WebComponent\"},\"name\":\"LA CISA Known Exploited Vulnerabilities_groupBy WebComponent\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA CVEs\",\"styleSettings\":{\"showBorder\":true}},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"53f2b813-6fbd-42ec-b045-c72170d4d68f\",\"cellValue\":\"ADXClusterParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu ||\",\"style\":\"primary\"},{\"id\":\"07586fd7-0959-4c1b-895a-477746452e64\",\"cellValue\":\"ADX Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"02172fbf-1a96-4a36-8563-ecb2fd97c88d\",\"cellValue\":\"ADX Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"f4463045-ca49-4cd0-8d33-9b7e9dcd5d2f\",\"cellValue\":\"ADX CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"983a7d50-0c5e-463b-8437-c34199736c31\",\"cellValue\":\"ADX Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"c2ca471c-1dc3-43b4-bb0e-799d610a7602\",\"cellValue\":\"ADX IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"b4a7866e-ef2b-4dad-b089-d514dfffb94d\",\"cellValue\":\"ADX Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"2d38fc21-3f5a-4dfe-a673-82c14b7b694d\",\"cellValue\":\"ADX SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"e56c4201-0cbb-4ea2-a10b-ce47637cfed1\",\"cellValue\":\"ADX Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX Navigation Menu_under CVEs\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"108d2291-2084-4fcb-b763-38e184af7b0a\",\"cellValue\":\"LAWorkspaceParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu  ||\",\"style\":\"primary\"},{\"id\":\"dbdf1ffc-323f-4e4d-8c57-67cb3ac9f5ac\",\"cellValue\":\"LA Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"f722de23-f606-4d1b-962a-3d3f5e7771ef\",\"cellValue\":\"LA Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"42474e59-a868-4f8e-93bf-a424559e520b\",\"cellValue\":\"LA CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"9e33ffc7-8a56-46e8-9cf4-262d9bd7ba72\",\"cellValue\":\"LA Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"153cf485-e82c-4b4d-adf8-3cd27f420016\",\"cellValue\":\"LA IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"7d2006da-a2ac-44ec-a21d-38be718be26f\",\"cellValue\":\"LA Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"7b02da06-1402-4483-a619-7cba76c74d1b\",\"cellValue\":\"LA SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"cca3a0d2-468f-4954-b89a-211d2081ab63\",\"cellValue\":\"LA Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA Navigation Menu_under CVEs\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Host Details\",\"expandable\":true,\"expanded\":true,\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where AssetType == 'HOST'\\\\r\\\\n|summarize Count=count() by AssetType,SnapshotDateTime\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Hosts Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"timechart\"},\"name\":\"ADX Hosts Over Time\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"5f1dde0d-e3a4-4908-b7e1-05b9bcbf8844\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_host_sort_order\",\"label\":\"Sort Order\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"desc\"}],\"style\":\"formHorizontal\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"ADX Host Sorting\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmHostAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|extend Domain = iff(isnotempty(Domain), Domain, Host)\\\\r\\\\n//|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by Domain,AssetName\\\\r\\\\n|summarize Count=count() by Domain\\\\r\\\\n|sort by Count {_adx_host_sort_order}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Hosts by Domain\",\"showRefreshButton\":true,\"exportFieldName\":\"Domain\",\"exportParameterName\":\"_adx_domain_name\",\"exportDefaultValue\":\"No Domain Selected\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"tiles\",\"gridSettings\":{\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Domain\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"70\",\"name\":\"ADX Hosts by Domain\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmHostAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|where Domain == '{_adx_domain_name}'\\\\r\\\\n|project-keep Host\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Hosts Lookup for '{_adx_domain_name}'\",\"noDataMessage\":\"Select a Domain to find related Hosts\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9},\"customWidth\":\"30\",\"name\":\"ADX Hosts Lookup\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX Host Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Host Details\",\"expandable\":true,\"expanded\":true,\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where AssetType_s == 'HOST'\\r\\n|summarize Count=count() by AssetType_s,SnapshotDateTime_t\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Hosts Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"timechart\"},\"name\":\"LA Hosts Over Time\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"5f1dde0d-e3a4-4908-b7e1-05b9bcbf8844\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_host_sort_order\",\"label\":\"Sort Order\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"desc\"}],\"style\":\"formHorizontal\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"LA Host Sorting\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmHostAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|extend Domain = iff(isnotempty(Domain_s), Domain_s, Host_s)\\r\\n//|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by Domain,AssetName\\r\\n|summarize Count=count() by Domain\\r\\n|sort by Count {_la_host_sort_order}\",\"size\":0,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Hosts by Domain\",\"showRefreshButton\":true,\"exportFieldName\":\"Domain\",\"exportParameterName\":\"_la_domain_name\",\"exportDefaultValue\":\"No Domain Selected\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"tiles\",\"gridSettings\":{\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Domain\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"70\",\"name\":\"LA Hosts by Domain\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmHostAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where Domain_s == '{_la_domain_name}'\\r\\n|project-keep Host_s\",\"size\":0,\"showAnalytics\":true,\"title\":\"Hosts Lookup for '{_la_domain_name}'\",\"noDataMessage\":\"Select a Domain to find related Hosts\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"customWidth\":\"30\",\"name\":\"LA Hosts Lookup by Domain\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA Host Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"0fbe0ab8-6391-4261-b97a-01ede8138e7d\",\"cellValue\":\"ADXClusterParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu ||\",\"style\":\"primary\"},{\"id\":\"3786254f-073d-449c-b59f-9a5c71285a57\",\"cellValue\":\"ADX Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"d2df6ea6-493a-48fc-8b31-8e6cdb108001\",\"cellValue\":\"ADX Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"d5198d8f-3640-40e3-9851-e7b0863d6d27\",\"cellValue\":\"ADX CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"abb75cc2-b3a8-444c-a85c-1b3979192fa6\",\"cellValue\":\"ADX Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"9fd271d4-e9ae-4ec0-986d-4b659ff27f65\",\"cellValue\":\"ADX IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"2fea4176-1100-427b-becd-5b6ef065eecf\",\"cellValue\":\"ADX Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"a0a1c0f8-fb1f-4d72-b58f-b7b1aee91a51\",\"cellValue\":\"ADX SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"3101a068-a4d1-4d99-be55-43b2716367a7\",\"cellValue\":\"ADX Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX Navigation Menu_under Host Details\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"eaf4e0eb-cb9c-489e-b945-3e281e663fef\",\"cellValue\":\"LAWorkspaceParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu  ||\",\"style\":\"primary\"},{\"id\":\"92053da1-631b-4c08-941a-65571195354d\",\"cellValue\":\"LA Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"787e44eb-84d7-49f1-9faf-94a92929c485\",\"cellValue\":\"LA Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"f9cd1ed7-02c5-473e-bd9d-cdaa4b12f06b\",\"cellValue\":\"LA CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"737853ba-2d53-4976-9b51-deb51b4a5886\",\"cellValue\":\"LA Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"a920e3da-838a-454b-b5dc-e26149a4764f\",\"cellValue\":\"LA IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"4c9ce1cb-34f6-4955-b92e-c1355e5ca929\",\"cellValue\":\"LA Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"63839210-ac97-400a-a4fc-f22f4ef9db0b\",\"cellValue\":\"LA SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"1c15a57c-b2cd-4fa6-82bc-e02db5570d7d\",\"cellValue\":\"LA Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA Navigation Menu_under Host Details\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"IP Address Details\",\"expandable\":true,\"expanded\":true,\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where AssetType == 'IP_ADDRESS'\\\\r\\\\n|summarize Count=count() by AssetType,SnapshotDateTime\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"IPs Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"timechart\"},\"name\":\"ADX IPs Over Time\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"5f1dde0d-e3a4-4908-b7e1-05b9bcbf8844\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_ip_sort_order\",\"label\":\"Sort Order\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"desc\"}],\"style\":\"formHorizontal\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"ADX IP Sorting\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmIpAddressAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|where array_length(IpBlocks) > 0\\\\r\\\\n|extend ReversedBlock = array_reverse(IpBlocks)\\\\r\\\\n|extend IpBlock = array_slice(ReversedBlock,0,0)\\\\r\\\\n|extend IpBlock = tostring(strcat_array(IpBlock,''))\\\\r\\\\n|where isnotempty(IpBlock)\\\\r\\\\n|summarize Count=count() by IpBlock\\\\r\\\\n|sort by Count {_adx_ip_sort_order}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"IPs by Block\",\"showRefreshButton\":true,\"exportFieldName\":\"IpBlock\",\"exportParameterName\":\"_adx_ip_block\",\"exportDefaultValue\":\"No IP Block Selected\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"tiles\",\"gridSettings\":{\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"IpBlock\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"80\",\"name\":\"ADX IPs by Block\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmIpAddressAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|where IpBlocks has '{_adx_ip_block}'\\\\r\\\\n|project-keep IpAddress\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"IPs Lookup for '{_adx_ip_block}'\",\"noDataMessage\":\"Select an IP Block to find active IPs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"IpBlock\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"20\",\"name\":\"ADX IPs Lookup by IP Block\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX IP Addres Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"IP Address Details\",\"expandable\":true,\"expanded\":true,\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where AssetType_s == 'IP_ADDRESS'\\r\\n|summarize Count=count() by AssetType_s,SnapshotDateTime_t\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"IPs Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"timechart\"},\"name\":\"ADX IPs Over Time\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"5f1dde0d-e3a4-4908-b7e1-05b9bcbf8844\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_ip_sort_order\",\"label\":\"Sort Order\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"desc\"}],\"style\":\"formHorizontal\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"LA IP Sorting\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmIpAddressAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where isnotempty(IpBlocks_s)\\r\\n|extend IpBlocks_j = parse_json(IpBlocks_s)\\r\\n|extend ReversedBlock = array_reverse(IpBlocks_j)\\r\\n|extend IpBlock = array_slice(ReversedBlock,0,0)\\r\\n|extend IpBlock = tostring(strcat_array(IpBlock,''))\\r\\n|where isnotempty(IpBlock)\\r\\n|summarize Count=count() by IpBlock\\r\\n|sort by Count {_la_ip_sort_order}\",\"size\":0,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"IPs by Block\",\"showRefreshButton\":true,\"exportFieldName\":\"IpBlock\",\"exportParameterName\":\"_la_ip_block\",\"exportDefaultValue\":\"No IP Block Selected\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"tiles\",\"gridSettings\":{\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"IpBlock\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"80\",\"name\":\"LA IPs by Block\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmIpAddressAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where IpBlocks_s has '{_la_ip_block}'\\r\\n|project-keep IPAddress\",\"size\":0,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"IPs Lookup for '{_la_ip_block}'\",\"noDataMessage\":\"Select an IP Block to find active IPs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":1000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"IpBlock\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"20\",\"name\":\"LA IPs Lookup by IP Block\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA IP Addres Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"7c96082a-4bab-4457-a537-83ee4e5f909c\",\"cellValue\":\"ADXClusterParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu ||\",\"style\":\"primary\"},{\"id\":\"42d1e3b7-64c4-4e43-936f-8c9100cef75f\",\"cellValue\":\"ADX Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"6a77be2d-ec7c-4bb1-8a49-e8c91f08ce0b\",\"cellValue\":\"ADX Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"04597b0b-7c81-47aa-8d03-7cea7d2ea4f2\",\"cellValue\":\"ADX CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"3e553019-46db-4bd9-8128-add64c437f0f\",\"cellValue\":\"ADX Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"9965f0ee-667a-44c9-82aa-236ccb04b483\",\"cellValue\":\"ADX IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"c21c09f0-7a4d-4af9-88df-707e975fa828\",\"cellValue\":\"ADX Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"15c21895-91b4-48ce-91dc-40ac65f2fedc\",\"cellValue\":\"ADX SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"0a3f8d85-6252-474e-a50a-99a9d285d100\",\"cellValue\":\"ADX Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX Navigation Menu_under IP Details\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"ddf5b6dd-4244-4879-9283-1b7e394debbe\",\"cellValue\":\"LAWorkspaceParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu  ||\",\"style\":\"primary\"},{\"id\":\"7a81c24d-82d2-4c86-b029-c2c572bdd0e0\",\"cellValue\":\"LA Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"294fcc2d-a032-4b7c-8127-fda3668d458d\",\"cellValue\":\"LA Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"784e8743-7b8c-4a6b-a487-1fdd312269da\",\"cellValue\":\"LA CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"584cd8fb-bae2-4daa-8ce9-88d1e749edf3\",\"cellValue\":\"LA Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"3505a727-f9a3-4b0e-9785-89491ab45076\",\"cellValue\":\"LA IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"42ae992c-3358-444d-b02c-28de597fe38a\",\"cellValue\":\"LA Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"8bed28a1-b3ff-487a-abff-3d55cec96173\",\"cellValue\":\"LA SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"8286a0a9-bdb6-46b1-8248-05dea71dd9c5\",\"cellValue\":\"LA Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA Navigation Menu_under IP Details\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Page Details\",\"expandable\":true,\"expanded\":true,\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where AssetType == 'PAGE'\\\\r\\\\n|summarize Count=count() by AssetType,SnapshotDateTime\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Pages Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"timechart\"},\"name\":\"ADX Pages Over Time\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"5f1dde0d-e3a4-4908-b7e1-05b9bcbf8844\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_page_sort_order\",\"label\":\"Sort Order\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"desc\"}],\"style\":\"formHorizontal\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"ADX Page Sorting\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmPageAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|where isnotempty(SiteStatus)\\\\r\\\\n|summarize Count=count() by SiteStatus\\\\r\\\\n|sort by Count {_adx_page_sort_order}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":4,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Pages by Site Status\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"SiteStatus\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"50\",\"name\":\"ADX Pages by Site Status\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmPageAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|extend ServicePort = todynamic(array_reverse(split(Service,':')))\\\\r\\\\n|mv-expand ServicePort limit 1\\\\r\\\\n|extend ServicePort = tostring(ServicePort)\\\\r\\\\n|extend Service = case(ServicePort == '443','HTTPS',ServicePort == '80','HTTP','OTHER')\\\\r\\\\n|summarize Count=count() by ServicePort,Service\\\\r\\\\n|sort by Count {_adx_page_sort_order}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":4,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Pages by Service\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Service\",\"formatter\":1},\"subtitleContent\":{\"columnMatch\":\"ServicePort\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"50\",\"name\":\"ADX Pages by Service\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX Page Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Page Details\",\"expandable\":true,\"expanded\":true,\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where AssetType_s == 'PAGE'\\r\\n|summarize Count=count() by AssetType_s,SnapshotDateTime_t\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Pages Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"timechart\"},\"name\":\"LA Pages Over Time\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"5f1dde0d-e3a4-4908-b7e1-05b9bcbf8844\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_page_sort_order\",\"label\":\"Sort Order\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"desc\"}],\"style\":\"formHorizontal\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"LA IP Sorting\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmPageAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where isnotempty(SiteStatus_s)\\r\\n|summarize Count=count() by SiteStatus_s\\r\\n|sort by Count {_la_page_sort_order}\",\"size\":4,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Pages by Site Status\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"SiteStatus_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"50\",\"name\":\"LA Pages by Site Status\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmPageAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|extend ServicePort = todynamic(array_reverse(split(Service_s,':')))\\r\\n|mv-expand ServicePort limit 1\\r\\n|extend ServicePort = tostring(ServicePort)\\r\\n|extend Service = case(ServicePort == '443','HTTPS',ServicePort == '80','HTTP','OTHER')\\r\\n|summarize Count=count() by ServicePort,Service\\r\\n|sort by Count {_la_page_sort_order}\",\"size\":4,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Pages by Service\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Service\",\"formatter\":1},\"subtitleContent\":{\"columnMatch\":\"ServicePort\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"50\",\"name\":\"LA Pages by Service\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA Page Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"5b2dc910-f58c-4bed-9bc2-257e39e9f769\",\"cellValue\":\"ADXClusterParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu ||\",\"style\":\"primary\"},{\"id\":\"c9d860ff-86b3-4760-9010-4ba9acf42b15\",\"cellValue\":\"ADX Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"6378e6fd-874c-4f19-a319-cf7f8569e03f\",\"cellValue\":\"ADX Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"76b889f7-0bbe-4516-9aa1-d1b834a806cc\",\"cellValue\":\"ADX CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"dd59feab-bdf8-42f8-87cf-f5f7cdf3b948\",\"cellValue\":\"ADX Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"b31ad5fb-04ea-4048-b0f1-7c89c52532a4\",\"cellValue\":\"ADX IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"08633da2-5b8d-469d-8c75-5209f4a2891c\",\"cellValue\":\"ADX Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"157631f7-8f4c-40bc-81b9-99576507c45c\",\"cellValue\":\"ADX SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"c1b7d538-e7b4-4851-93a7-82ffb94f16bb\",\"cellValue\":\"ADX Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX Navigation Menu_under Page Details\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"8ebe96a2-fa66-4f64-b2cb-20f45d254540\",\"cellValue\":\"LAWorkspaceParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu  ||\",\"style\":\"primary\"},{\"id\":\"9f7fbd82-001c-4066-8206-4b97991ee201\",\"cellValue\":\"LA Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"91335b23-04e9-41a3-a776-41e6f034f6f1\",\"cellValue\":\"LA Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"0b028abd-2ebb-4d02-a739-8dac84efb764\",\"cellValue\":\"LA CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"58dbb33a-3d59-4b41-9bcc-af99008bd954\",\"cellValue\":\"LA Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"edb9ca6b-7aab-4485-a45b-92b47f12810c\",\"cellValue\":\"LA IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"e0820502-c59e-4dcc-8a18-4172bdd1722b\",\"cellValue\":\"LA Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"5ef2f455-5260-4147-8973-3833e0dc2b55\",\"cellValue\":\"LA SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"0b7b04f7-0344-4ddf-8039-fd80337cdce8\",\"cellValue\":\"LA Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA Navigation Menu_under Page Details\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"SSL Certificate Details\",\"expandable\":true,\"expanded\":true,\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where AssetType == 'SSL_CERT'\\\\r\\\\n|summarize Count=count() by AssetType,SnapshotDateTime\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"SSL Certificates Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"timechart\"},\"name\":\"ADX SSL Certificates Over Time\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmRisk\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where MetricDisplayName contains \\\\\\\"certificates\\\\\\\"\\\\r\\\\n|extend ReversedAuditTrail = array_reverse(AssetDiscoveryAuditTrail)\\\\r\\\\n|project-away AssetDiscoveryAuditTrail, AssetLastSeen\\\\r\\\\n|mv-expand ReversedAuditTrail limit 1\\\\r\\\\n|join kind=inner (EasmSslCertAsset\\\\r\\\\n    | where WorkspaceName == workspace\\\\r\\\\n    | where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    | where (AssetLastSeen > InvalidAfter or (InvalidAfter > now() and InvalidAfter-30d < now()))\\\\r\\\\n    | extend Status = iff((AssetLastSeen > InvalidAfter),'Expired','Expiring in 30 days')\\\\r\\\\n    | extend CertCommonName = strcat_array(SubjectCommonNames,'')\\\\r\\\\n    | extend CertSha1 = AssetName\\\\r\\\\n    | project-keep AssetUuid, AssetLastSeen, CertCommonName, CertSha1, InvalidAfter,Status\\\\r\\\\n    ) on AssetUuid\\\\r\\\\n|project-keep ReversedAuditTrail,AssetLastSeen,CertCommonName,CertSha1,InvalidAfter,Status\\\\r\\\\n|extend AssetName = tostring(ReversedAuditTrail.AssetType)\\\\r\\\\n|project-away ReversedAuditTrail\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(AssetLastSeen, *) by AssetName,CertCommonName,CertSha1,InvalidAfter,Status\\\\r\\\\n|order by InvalidAfter asc\\\\r\\\\n|project-reorder AssetName,Status,InvalidAfter,AssetLastSeen\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\" SSL Certs Expired or Expiring Soon\",\"noDataMessage\":\"No expired or soon-to-expire certificates found\",\"showRefreshButton\":true,\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"customWidth\":\"50\",\"name\":\" ADX SSL Certs Expired or Expiring Soon\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmSslCertAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n|where IsSelfSigned == true\\\\r\\\\n|mv-expand SubjectCommonNames\\\\r\\\\n|extend CommonName = tostring(SubjectCommonNames)\\\\r\\\\n|join (EasmHostAsset\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |mv-expand SslCerts\\\\r\\\\n    |extend HostThumb = tostring(SslCerts)\\\\r\\\\n    |extend SeenOnHost = Host\\\\r\\\\n    |project-keep SeenOnHost,HostThumb\\\\r\\\\n) on $left.Thumbprint == $right.HostThumb\\\\r\\\\n|join (EasmIpAddressAsset\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |mv-expand SslCerts\\\\r\\\\n    |extend IpThumb = tostring(SslCerts)\\\\r\\\\n    |extend SeenOnIp = IpAddress\\\\r\\\\n    |project-keep SeenOnIp,IpThumb\\\\r\\\\n) on $left.Thumbprint == $right.IpThumb\\\\r\\\\n|extend Sha1 = Thumbprint\\\\r\\\\n|project-keep CommonName,SeenOnHost,SeenOnIp,Sha1\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"aggregation\":2,\"showAnalytics\":true,\"title\":\"Self-Signed Certificates\",\"noDataMessage\":\"No self-signed certificates found\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Group\",\"formatter\":1}],\"filter\":true,\"hierarchySettings\":{\"treeType\":1,\"groupBy\":[\"CommonName\"],\"expandTopLevel\":false}},\"graphSettings\":{\"type\":2,\"topContent\":{\"columnMatch\":\"SeenOnHost\"},\"centerContent\":{\"columnMatch\":\"CommonName\"},\"bottomContent\":{\"columnMatch\":\"SeenOnIp\"},\"hivesContent\":{\"columnMatch\":\"CommonName\",\"formatter\":1},\"nodeIdField\":\"CommonName\",\"sourceIdField\":\"SeenOnHost\",\"targetIdField\":\"SeenOnIp\",\"graphOrientation\":3,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":{\"nodeColorField\":\"SeenOnIp\",\"type\":1,\"colorPalette\":\"default\"},\"groupByField\":\"CommonName\",\"hivesMargin\":5}},\"customWidth\":\"50\",\"name\":\"ADX Self-Signed Certificates\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmSslCertAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|mv-expand IssuerOrganizations\\\\r\\\\n|where isnotempty(IssuerOrganizations)\\\\r\\\\n|extend Org = tostring(IssuerOrganizations)\\\\r\\\\n|summarize Count=count() by Org\\\\r\\\\n|sort by Count asc\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"aggregation\":2,\"showAnalytics\":true,\"title\":\"Certificate Issuer Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"categoricalbar\"},\"customWidth\":\"50\",\"name\":\"ADX Certificate Issuer Orgs\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmSslCertAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|mv-expand SubjectOrganizations\\\\r\\\\n|where isnotempty(SubjectOrganizations)\\\\r\\\\n|extend Org = tostring(SubjectOrganizations)\\\\r\\\\n|summarize Count=count() by Org\\\\r\\\\n|sort by Count asc\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"aggregation\":2,\"showAnalytics\":true,\"title\":\"Certificate Subject Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"categoricalbar\"},\"customWidth\":\"50\",\"name\":\"ADX Certificate Subject Orgs\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX SSL Certificate Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"SSL Certificate Details\",\"expandable\":true,\"expanded\":true,\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where AssetType_s == 'SSL_CERT'\\r\\n|summarize Count=count() by AssetType_s,SnapshotDateTime_t\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"SSL Certificates Over Time\",\"showRefreshButton\":true,\"exportParameterName\":\"_ssl_param\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"timechart\"},\"name\":\"ADX SSL Certificates Over Time\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmRisk_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where MetricDisplayName_s contains \\\"certificates\\\"\\r\\n|extend ReversedAuditTrail = array_reverse(parse_json(AssetDiscoveryAuditTrail_s))\\r\\n|project-away AssetDiscoveryAuditTrail_s, AssetLastSeen_t\\r\\n|mv-expand ReversedAuditTrail limit 1\\r\\n|join kind=inner (EasmSslCertAsset_CL\\r\\n    | where WorkspaceName_s == workspace\\r\\n    | where AssetLastSeen_t {_la_lastseen:query}\\r\\n    | where (AssetLastSeen_t > InvalidAfter_t or (InvalidAfter_t > now() and InvalidAfter_t-30d < now()))\\r\\n    | extend Status = iff((AssetLastSeen_t > InvalidAfter_t),'Expired','Expiring in 30 days')\\r\\n    | extend CertCommonName = trim(@'[\\\\[\\\\]\\\\s\\\\\\\"]+',SubjectCommonNames_s)\\r\\n    //| extend CertCommonName = strcat_array(SubjectCommonNames,'')\\r\\n    | extend CertSha1 = AssetName_s\\r\\n    | project-keep AssetUuid_g, AssetLastSeen_t, CertCommonName, CertSha1, InvalidAfter_t, Status\\r\\n    ) on AssetUuid_g\\r\\n|project-keep ReversedAuditTrail,AssetLastSeen_t,CertCommonName,CertSha1,InvalidAfter_t,Status\\r\\n|extend AssetName = tostring(ReversedAuditTrail.AssetType)\\r\\n|project-away ReversedAuditTrail\\r\\n|summarize hint.strategy=shuffle arg_max(AssetLastSeen_t, *) by tostring(AssetName),CertCommonName,CertSha1,InvalidAfter_t,Status\\r\\n|order by InvalidAfter_t asc\\r\\n|project-reorder AssetName,Status,InvalidAfter_t,AssetLastSeen_t\",\"size\":1,\"showAnalytics\":true,\"title\":\" SSL Certs Expired or Expiring Soon\",\"noDataMessage\":\"No expired or soon-to-expire certificates found\",\"showRefreshButton\":true,\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"customWidth\":\"50\",\"name\":\" ADX SSL Certs Expired or Expiring Soon\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmSslCertAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where AssetLastSeen_t {_la_lastseen:query}\\r\\n|where IsSelfSigned_b == true\\r\\n|extend CommonName = trim(@'[\\\\[\\\\]\\\\s\\\\\\\"]+',SubjectCommonNames_s)\\r\\n|join (EasmHostAsset_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(SslCerts_s)\\r\\n    |extend SslCerts_j = parse_json(SslCerts_s)\\r\\n    |mv-expand SslCerts_j\\r\\n    |extend HostThumb = tostring(SslCerts_j)\\r\\n    |extend SeenOnHost = AssetName_s\\r\\n    |project-keep SeenOnHost,HostThumb\\r\\n) on $left.Thumbprint_s == $right.HostThumb\\r\\n|join (EasmIpAddressAsset_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(SslCerts_s)\\r\\n    |extend SslCerts_j = parse_json(SslCerts_s)\\r\\n    |mv-expand SslCerts_j\\r\\n    |extend IpThumb = tostring(SslCerts_j)\\r\\n    |extend SeenOnIp = AssetName_s\\r\\n    |project-keep SeenOnIp,IpThumb\\r\\n) on $left.Thumbprint_s == $right.IpThumb\\r\\n|extend Sha1 = Thumbprint_s\\r\\n|project-keep CommonName,SeenOnHost,SeenOnIp,Sha1\",\"size\":1,\"aggregation\":2,\"showAnalytics\":true,\"title\":\"Self-Signed Certificates\",\"noDataMessage\":\"No self-signed certificates found\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Group\",\"formatter\":1}],\"filter\":true,\"hierarchySettings\":{\"treeType\":1,\"groupBy\":[\"CommonName\"],\"expandTopLevel\":false}},\"graphSettings\":{\"type\":2,\"topContent\":{\"columnMatch\":\"SeenOnHost\"},\"centerContent\":{\"columnMatch\":\"CommonName\"},\"bottomContent\":{\"columnMatch\":\"SeenOnIp\"},\"hivesContent\":{\"columnMatch\":\"CommonName\",\"formatter\":1},\"nodeIdField\":\"CommonName\",\"sourceIdField\":\"SeenOnHost\",\"targetIdField\":\"SeenOnIp\",\"graphOrientation\":3,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":{\"nodeColorField\":\"SeenOnIp\",\"type\":1,\"colorPalette\":\"default\"},\"groupByField\":\"CommonName\",\"hivesMargin\":5}},\"customWidth\":\"50\",\"name\":\"LA Self-Signed Certificates\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmSslCertAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where isnotempty(IssuerOrganizations_s)\\r\\n|extend IssuerOrganizations_j = parse_json(IssuerOrganizations_s)\\r\\n|mv-expand IssuerOrganizations_j\\r\\n|where isnotempty(IssuerOrganizations_j)\\r\\n|extend Org = tostring(IssuerOrganizations_j)\\r\\n|summarize Count=count() by Org\\r\\n|sort by Count asc\",\"size\":0,\"aggregation\":2,\"showAnalytics\":true,\"title\":\"Certificate Issuer Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"categoricalbar\"},\"customWidth\":\"50\",\"name\":\"LA Certificate Issuer Orgs\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmSslCertAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where isnotempty(SubjectOrganizations_s)\\r\\n|extend SubjectOrganizations_j = parse_json(SubjectOrganizations_s)\\r\\n|mv-expand SubjectOrganizations_j\\r\\n|where isnotempty(SubjectOrganizations_j)\\r\\n|extend Org = tostring(SubjectOrganizations_j)\\r\\n|summarize Count=count() by Org\\r\\n|sort by Count asc\",\"size\":0,\"aggregation\":2,\"showAnalytics\":true,\"title\":\"Certificate Subject Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"categoricalbar\"},\"customWidth\":\"50\",\"name\":\"ADX Certificate Subject Orgs\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA SSL Certificate Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"4b247884-75ea-4bf3-822c-023c806cbf27\",\"cellValue\":\"ADXClusterParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu ||\",\"style\":\"primary\"},{\"id\":\"eee41f64-2678-4a11-b78b-0b1dbaec4133\",\"cellValue\":\"ADX Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"2df52247-c7b2-4fce-a630-305b768ba59c\",\"cellValue\":\"ADX Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"8bc822d3-5cd8-4e75-b57b-fd90c86360a6\",\"cellValue\":\"ADX CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"0a0cda0e-a3a3-44b4-a683-c28c134385c9\",\"cellValue\":\"ADX Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"f37c6dd0-0930-4751-a638-7e30a1185486\",\"cellValue\":\"ADX IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"a9730710-8dea-4469-8dfa-3892c28d53e9\",\"cellValue\":\"ADX Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"db1be451-f2ef-4661-a895-79cedb946140\",\"cellValue\":\"ADX SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"8edf3aa5-d56c-4d54-9fe6-4017e7ed6ea6\",\"cellValue\":\"ADX Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX Navigation Menu_under Cert Details\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"c9741224-3eca-4108-8885-38a62e6e2d64\",\"cellValue\":\"LAWorkspaceParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu  ||\",\"style\":\"primary\"},{\"id\":\"64db5413-ed53-404b-bc21-2fdfc486260b\",\"cellValue\":\"LA Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"f6b58794-fed7-444a-bc28-d9bffc3b20e7\",\"cellValue\":\"LA Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"71c39c61-70ba-4fa4-b477-3f212191edd1\",\"cellValue\":\"LA CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"e6741c05-3fec-4f19-886d-76aeb3702a4c\",\"cellValue\":\"LA Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"2c5411fc-b0e0-4039-8bcd-759d327d78ce\",\"cellValue\":\"LA IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"b3479020-7367-46b1-b1d6-5aea47dec118\",\"cellValue\":\"LA Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"0127a0f4-9532-46a4-8104-9c80b837b8b9\",\"cellValue\":\"LA SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"dd519032-f2b0-4509-b1a6-7ac7e824795e\",\"cellValue\":\"LA Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA Navigation Menu_under Cert Details\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Domain Details\",\"expandable\":true,\"expanded\":true,\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where AssetType == 'DOMAIN'\\\\r\\\\n|summarize Count=count() by AssetType,SnapshotDateTime\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Domains Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"timechart\",\"chartSettings\":{\"group\":null,\"createOtherGroup\":0}},\"name\":\"ADX Domains Over Time\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmDomainAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|mv-expand AdminOrgs \\\\r\\\\n|where isnotempty(AdminOrgs)\\\\r\\\\n|extend Org = tostring(AdminOrgs)\\\\r\\\\n|summarize Count=count() by Org\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":3,\"showAnalytics\":true,\"title\":\"Admin Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Org\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"ADX Admin Orgs\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmDomainAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|mv-expand RegistrantOrgs \\\\r\\\\n|where isnotempty(RegistrantOrgs)\\\\r\\\\n|extend Org = tostring(RegistrantOrgs)\\\\r\\\\n|summarize Count=count() by Org\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":3,\"showAnalytics\":true,\"title\":\"Registrant Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Org\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"ADX Registrant Orgs\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmDomainAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|mv-expand TechnicalOrgs \\\\r\\\\n|where isnotempty(TechnicalOrgs)\\\\r\\\\n|extend Org = tostring(TechnicalOrgs)\\\\r\\\\n|summarize Count=count() by Org\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":3,\"showAnalytics\":true,\"title\":\"Technical Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Org\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"ADX Technical Orgs\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmDomainAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|mv-expand AdminContacts \\\\r\\\\n|where isnotempty(AdminContacts)\\\\r\\\\n|extend Contact = tostring(AdminContacts)\\\\r\\\\n|summarize Count=count() by Contact\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":3,\"showAnalytics\":true,\"title\":\"Admin Contacts\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Contact\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"ADX Admin Contacts\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmDomainAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|mv-expand AdminContacts \\\\r\\\\n|where isnotempty(AdminContacts)\\\\r\\\\n|extend Contact = tostring(AdminContacts)\\\\r\\\\n|summarize Count=count() by Contact\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":3,\"showAnalytics\":true,\"title\":\"Registrant Contacts\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Contact\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"ADX Registrant Contacts\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmDomainAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime == '{_adx_snapshot}'\\\\r\\\\n|mv-expand TechnicalContacts \\\\r\\\\n|where isnotempty(TechnicalContacts)\\\\r\\\\n|extend Contact = tostring(TechnicalContacts)\\\\r\\\\n|summarize Count=count() by Contact\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":3,\"showAnalytics\":true,\"title\":\"Technical Contacts\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Contact\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"ADX Technical Contacts\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX Domain Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Domain Details\",\"expandable\":true,\"expanded\":true,\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where AssetType_s == 'DOMAIN'\\r\\n|summarize Count=count() by AssetType_s,SnapshotDateTime_t\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Domains Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"timechart\",\"chartSettings\":{\"group\":null,\"createOtherGroup\":0}},\"name\":\"LA Domains Over Time\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmDomainAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where isnotempty(AdminOrgs_s)\\r\\n|extend AdminOrgs_j = parse_json(AdminOrgs_s)\\r\\n|mv-expand AdminOrgs_j \\r\\n|where isnotempty(AdminOrgs_j)\\r\\n|extend Org = tostring(AdminOrgs_j)\\r\\n|summarize Count=count() by Org\",\"size\":3,\"showAnalytics\":true,\"title\":\"Admin Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Org\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"LA Admin Orgs\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmDomainAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where isnotempty(RegistrantOrgs_s)\\r\\n|extend RegistrantOrgs_j = parse_json(RegistrantOrgs_s)\\r\\n|mv-expand RegistrantOrgs_j \\r\\n|where isnotempty(RegistrantOrgs_j)\\r\\n|extend Org = tostring(RegistrantOrgs_j)\\r\\n|summarize Count=count() by Org\",\"size\":3,\"showAnalytics\":true,\"title\":\"Registrant Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Org\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"LA Registrant Orgs\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmDomainAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where isnotempty(TechnicalOrgs_s)\\r\\n|extend TechnicalOrgs_j = parse_json(TechnicalOrgs_s)\\r\\n|mv-expand TechnicalOrgs_j \\r\\n|where isnotempty(TechnicalOrgs_j)\\r\\n|extend Org = tostring(TechnicalOrgs_j)\\r\\n|summarize Count=count() by Org\",\"size\":3,\"showAnalytics\":true,\"title\":\"Technical Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Org\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"LA Technical Orgs\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmDomainAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where isnotempty(AdminContacts_s)\\r\\n|extend AdminContacts_j = parse_json(AdminContacts_s)\\r\\n|mv-expand AdminContacts_j \\r\\n|where isnotempty(AdminContacts_j)\\r\\n|extend Contact = tostring(AdminContacts_j)\\r\\n|summarize Count=count() by Contact\",\"size\":3,\"showAnalytics\":true,\"title\":\"Admin Contacts\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Contact\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"LA Admin Contacts\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmDomainAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where isnotempty(RegistrantContacts_s)\\r\\n|extend RegistrantContacts_j = parse_json(RegistrantContacts_s)\\r\\n|mv-expand RegistrantContacts_j \\r\\n|where isnotempty(RegistrantContacts_j)\\r\\n|extend Contact = tostring(RegistrantContacts_j)\\r\\n|summarize Count=count() by Contact\",\"size\":3,\"showAnalytics\":true,\"title\":\"Registrant Contacts\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Contact\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"LA Registrant Contacts\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmDomainAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t == '{_la_snapshot}'\\r\\n|where isnotempty(TechnicalContacts_s)\\r\\n|extend TechnicalContacts_j = parse_json(TechnicalContacts_s)\\r\\n|mv-expand TechnicalContacts_j \\r\\n|where isnotempty(TechnicalContacts_j)\\r\\n|extend Contact = tostring(TechnicalContacts_j)\\r\\n|summarize Count=count() by Contact\",\"size\":3,\"showAnalytics\":true,\"title\":\"Technical Contacts\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Contact\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"LA Technical Contacts\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA Domain Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"6603ac30-9a8c-4d43-89a7-01e71ea2abf6\",\"cellValue\":\"ADXClusterParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu ||\",\"style\":\"primary\"},{\"id\":\"6803c93b-0881-4ee1-9a52-5208a324175f\",\"cellValue\":\"ADX Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"9209d361-bc81-4979-8741-b8c84deff765\",\"cellValue\":\"ADX Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"45b6e6d8-6d55-49a0-a3e4-be2092c37625\",\"cellValue\":\"ADX CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"ad15074d-b64b-41ac-8d9c-2d923b1fd648\",\"cellValue\":\"ADX Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"37b6beb4-ab7b-4c2b-937f-3b209f7e59b5\",\"cellValue\":\"ADX IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"3848550a-c180-48ea-a698-0132d5424323\",\"cellValue\":\"ADX Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"7c614f0e-6c57-4c29-aea6-b1e0c69e8bd3\",\"cellValue\":\"ADX SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"c1ae10b4-0b45-4328-9609-ad32864f5afd\",\"cellValue\":\"ADX Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADX Navigation Menu_under Domain Details\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"9e6f7895-3e3a-4972-83d1-27392e3b32db\",\"cellValue\":\"LAWorkspaceParameters\",\"linkTarget\":\"step\",\"linkLabel\":\"Workbook Parameters\",\"preText\":\"Navigation Menu  ||\",\"style\":\"primary\"},{\"id\":\"456263b2-3f87-402f-8df5-0b61a00607f4\",\"cellValue\":\"LA Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"322d0ce2-07b1-46a2-83dc-601b30de693c\",\"cellValue\":\"LA Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"f9076bf5-9e5b-4c47-864e-a899ba42742c\",\"cellValue\":\"LA CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"c99bc77d-3f52-490b-b083-35ebbb998384\",\"cellValue\":\"LA Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"fc6f6ffa-cb25-4f63-b6e5-db71da9f1eaf\",\"cellValue\":\"LA IP Addres Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"c227ca35-4553-4b2f-8185-fd86651986b9\",\"cellValue\":\"LA Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"a7cca797-3ef0-4dc8-a01a-e26178193802\",\"cellValue\":\"LA SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"0aa8eafe-1f35-45dc-973c-9b21cb9711b2\",\"cellValue\":\"LA Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LA Navigation Menu_under Domain Details\"}],\"isLocked\":false,\"fallbackResourceIds\":[],\"fromTemplateId\":\"sentinel-UserWorkbook\"}",
        "version": "1.0",
        "sourceId": "[variables('workbookSourceId')]",
        "category": "[parameters('workbookType')]"
      }
    }
  ],
  "outputs": {
    "workbookId": {
      "type": "string",
      "value": "[resourceId( 'microsoft.insights/workbooks', parameters('workbookId'))]"
    }
  },
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"
}
